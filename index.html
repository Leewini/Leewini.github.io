<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="Welcome">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Welcome">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Welcome">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>Welcome</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Welcome</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Where there's a will, there's a way.</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/06/ä½æ©ç -BitMask-çš„ä»‹ç»ä¸ä½¿ç”¨/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Leewin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Welcome">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/06/ä½æ©ç -BitMask-çš„ä»‹ç»ä¸ä½¿ç”¨/" itemprop="url">ä½æ©ç (BitMask)çš„ä»‹ç»ä¸ä½¿ç”¨</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-06T23:28:27+08:00">
                2018-05-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h3><p>ä½è¿ç®—åœ¨æˆ‘ä»¬å®é™…å¼€å‘ä¸­ç”¨å¾—å¾ˆå°‘ï¼Œä¸»è¦åŸå› è¿˜æ˜¯å®ƒå¯¹äºæˆ‘ä»¬è€Œè¨€ä¸å¥½è¯»ã€ä¸å¥½æ‡‚ã€ä¹Ÿä¸å¥½è®¡ç®—ï¼Œå¦‚æœä¸ç»å¸¸å®è·µï¼Œå¾ˆå®¹æ˜“å°±ç”Ÿç–äº†ã€‚ä½†å®é™…ä¸Šï¼Œä½è¿ç®—æ˜¯ä¸€ç§å¾ˆå¥½çš„è¿ç®—æ€æƒ³ï¼Œå®ƒçš„ä¼˜ç‚¹è‡ªç„¶æ˜¯è®¡ç®—å¿«ï¼Œä»£ç æ›´å°‘ã€‚</p>
<h3 id="äºŒã€åŸºæœ¬çŸ¥è¯†ä»‹ç»"><a href="#äºŒã€åŸºæœ¬çŸ¥è¯†ä»‹ç»" class="headerlink" title="äºŒã€åŸºæœ¬çŸ¥è¯†ä»‹ç»"></a>äºŒã€åŸºæœ¬çŸ¥è¯†ä»‹ç»</h3><ul>
<li>äºŒè¿›åˆ¶ï¼š<br>äºŒè¿›åˆ¶æ˜¯ç”±1å’Œ0ä¸¤ä¸ªæ•°å­—ç»„æˆçš„ï¼Œå®ƒå¯ä»¥è¡¨ç¤ºä¸¤ç§çŠ¶æ€ï¼Œå³å¼€å’Œå…³ã€‚æ‰€æœ‰è¾“å…¥ç”µè„‘çš„ä»»ä½•ä¿¡æ¯æœ€ç»ˆéƒ½è¦è½¬åŒ–ä¸ºäºŒè¿›åˆ¶ã€‚ç›®å‰é€šç”¨çš„æ˜¯ASCIIç ã€‚æœ€åŸºæœ¬çš„å•ä½ä¸ºbitã€‚</li>
<li>ä½è¿ç®—ï¼š<br>ç¨‹åºä¸­çš„æ‰€æœ‰æ•°åœ¨è®¡ç®—æœºå†…å­˜ä¸­éƒ½æ˜¯ä»¥äºŒè¿›åˆ¶çš„å½¢å¼å‚¨å­˜çš„ã€‚ä½è¿ç®—è¯´ç©¿äº†ï¼Œå°±æ˜¯ç›´æ¥å¯¹æ•´æ•°åœ¨å†…å­˜ä¸­çš„äºŒè¿›åˆ¶ä½è¿›è¡Œæ“ä½œã€‚æ¯”å¦‚ï¼Œandè¿ç®—æœ¬æ¥æ˜¯ä¸€ä¸ªé€»è¾‘è¿ç®—ç¬¦ï¼Œä½†æ•´æ•°ä¸æ•´æ•°ä¹‹é—´ä¹Ÿå¯ä»¥è¿›è¡Œandè¿ç®—ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œ6çš„äºŒè¿›åˆ¶æ˜¯110ï¼Œ11çš„äºŒè¿›åˆ¶æ˜¯1011ï¼Œé‚£ä¹ˆ6 and 11çš„ç»“æœå°±æ˜¯2ï¼Œå®ƒæ˜¯äºŒè¿›åˆ¶å¯¹åº”ä½è¿›è¡Œé€»è¾‘è¿ç®—çš„ç»“æœï¼ˆ0è¡¨ç¤ºFalseï¼Œ1è¡¨ç¤ºTrueï¼Œç©ºä½éƒ½å½“0å¤„ç†ï¼‰ã€‚</li>
</ul>
<h3 id="ä¸‰ã€é—®é¢˜å¼•ç”¨"><a href="#ä¸‰ã€é—®é¢˜å¼•ç”¨" class="headerlink" title="ä¸‰ã€é—®é¢˜å¼•ç”¨"></a>ä¸‰ã€é—®é¢˜å¼•ç”¨</h3><ul>
<li>è€é¼ è¯•æ¯’<br>æœ‰1000ç“¶æ°´ï¼Œå…¶ä¸­æœ‰ä¸€ç“¶æœ‰æ¯’ï¼Œå°ç™½é¼ åªè¦å°ä¸€ç‚¹å¸¦æ¯’çš„æ°´24å°æ—¶åå°±ä¼šæ­»äº¡ï¼Œé—®è‡³å°‘è¦å¤šå°‘åªå°ç™½é¼ æ‰èƒ½åœ¨24å°æ—¶å†…é‰´åˆ«å‡ºå“ªç“¶æ°´æœ‰æ¯’ï¼Ÿ</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/6544436-e39714047c20c21e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="è€é¼ è¯•æ¯’.png"></p>
<p>è¿™é‡Œï¼Œä½æ©ç çš„ä½¿ç”¨å°±å¯ä»¥å·§å¦™çš„è§£å†³æ­¤é—®é¢˜ã€‚</p>
<p>æˆ‘ä»¬å…ˆå°†é—®é¢˜ç®€åŒ–ä¸€ä¸‹ï¼šå‡è®¾åªæœ‰8ç“¶æ°´ï¼Œå…¶ä¸­1ç“¶æœ‰æ¯’ã€‚</p>
<p><img src="https://upload-images.jianshu.io/upload_images/6544436-64cd99c43327845d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="8æ¯æ°´åˆ†åˆ«ç¼–å·.png"></p>
<p>å°†è¯¥çŸ©é˜µè½¬ç½®ï¼Œå¾—ï¼š</p>
<p><img src="https://upload-images.jianshu.io/upload_images/6544436-7b711ad635d02818.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ°´æ¯çŸ©é˜µè½¬ç½®.png"></p>
<p>ä¾ä¸Šè¿°åœºæ™¯ï¼Œå–4åªå®¹å™¨ï¼Œè½¬ç½®åçš„çŸ©é˜µæ•°åˆ—é…ç»„åˆæº¶æ¶²ï¼š<br>å–æ•°ä½ä¸Šä¸º1çš„æ°´ï¼Œæ”¾å…¥ç›¸åº”çš„å®¹å™¨ï¼Œå³ï¼š<br>ç¬¬ä¸€æ¯ï¼šåªåŒ…å«8å·æ°´<br>ç¬¬äºŒæ¯ï¼šåŒ…å«4ã€5ã€6ã€7å·æ°´<br>ç¬¬ä¸‰æ¯ï¼šåŒ…å«2ã€3ã€6ã€7å·æ°´<br>ç¬¬å››æ¯ï¼šåŒ…å«1ã€3ã€5ã€7å·æ°´</p>
<p>å–4åªè€é¼ ï¼Œç¼–å·1ã€2ã€3ã€4ï¼Œåˆ†åˆ«å–ä¸‹ç¬¬ä¸€æ¯â€¦ç¬¬å››æ¯æ°´ï¼Œ<br>4åªè€é¼ çš„ç”Ÿæ­»çŠ¶æ€ä¾æ¬¡è®°ä¸º w x y zï¼Œï¼ˆw,x,y,z = {0,1}ï¼‰<br>æ­»äº¡è®°ä½œ1ï¼Œéæ­»äº¡è®°ä½œ0<br>å°†äºŒè¿›åˆ¶æ•°åˆ—wxyzè½¬ä¸ºåè¿›åˆ¶ï¼Œåˆ™å¾—åˆ°æœ‰æ¯’æ°´çš„å·ç ã€‚<br>å‡è®¾6å·æ°´æœ‰æ¯’ï¼Œé‚£ä¹ˆå¾€å›æ¨ç®—ï¼Œä¸éš¾çœ‹å‡ºï¼Œç¬¬2ã€3åªè€é¼ ä¼šæ­»äº¡ï¼Œ<br>å¾—åˆ°çš„wxyzçš„æ•°åˆ—å°±æ˜¯0110ï¼Œè½¬åè¿›åˆ¶åå°±æ˜¯6ã€‚</p>
<p>å°†1000ç“¶ä¾æ¬¡ç¼–å·ï¼š1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œâ€¦ï¼Œ1000ï¼› ä¸”éƒ½è®°ä½œäºŒè¿›åˆ¶ï¼›<br>é‚£æˆ‘ä»¬è¦ç”¨å¤šå°‘ä½æ¥è¡¨ç¤ºå‘¢ï¼Ÿ<br>æ€»æ•°æ˜¯1000ï¼Œ2^9=512ï¼Œ 2^10=1024ï¼Œäºæ˜¯è‡³å°‘è¦10ä½æ‰å¤Ÿè¡¨ç¤ºï¼Œ<br>ä¹Ÿå°±æ˜¯ï¼š0000000001ï¼Œ0000000010ï¼Œ0000000011ï¼Œâ€¦ï¼Œ1111101000ï¼›<br>é“ç†åŒä¸Šã€‚</p>
<h3 id="å››ã€ç»“åˆå®é™…é—®é¢˜"><a href="#å››ã€ç»“åˆå®é™…é—®é¢˜" class="headerlink" title="å››ã€ç»“åˆå®é™…é—®é¢˜"></a>å››ã€ç»“åˆå®é™…é—®é¢˜</h3><p>æˆ‘ä»¬å·²ç»è§è¯†äº†äºŒè¿›åˆ¶çš„å‰å®³ä¹‹å¤„äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ç»“åˆä»£ç æ¥çœ‹çœ‹ï¼Œåœ¨iOSå¼€å‘ä¸­çš„åº”ç”¨ï¼ˆå…¶å®åœ¨ä»»ä½•å¼€å‘ä¸­éƒ½ä¸€æ ·ï¼‰</p>
<ul>
<li>åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸é‡åˆ°æƒé™çš„åˆ¤æ–­çš„é—®é¢˜ï¼Œæ¯”å¦‚è¯´ï¼Œä¸åŒçš„ç”¨æˆ·å¯¹ç³»ç»Ÿæœ‰ä¸åŒçš„æ“ä½œæƒé™ï¼Œæœ‰çš„ç”¨æˆ·å¯èƒ½æœ‰å¤šç§æƒé™ï¼Œæˆ‘ä»¬æœ€å¸¸è§„çš„åŠæ³•å°±æ˜¯æ¯ä¸€ä¸ªæƒé™å®šä¹‰ä¸€ä¸ªBOOLå€¼ã€‚<br>å‡è®¾ï¼ŒæŸç³»ç»Ÿæœ‰4ç§æƒé™ï¼Œé‚£ä¹ˆï¼Œå°±æœ‰äº†ï¼š<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">BM_User</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">BOOL</span> permission1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">BOOL</span> permission2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">BOOL</span> permission3;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">BOOL</span> permission4;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>é‚£ç”¨æˆ·AåŒæ—¶æ‹¥æœ‰permission1ã€permission2ã€permission4æ€ä¹ˆè¡¨ç¤ºå‘¢ï¼Ÿ<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">BM_User *userA = [[BM_User alloc] init];</span><br><span class="line">userA.permission1 = <span class="literal">YES</span>;</span><br><span class="line">userA.permission2 = <span class="literal">YES</span>;</span><br><span class="line">userA.permission4 = <span class="literal">YES</span>;</span><br></pre></td></tr></table></figure></p>
<p>è¿™æ ·çš„æ“ä½œå¤§å®¶è§å¤šäº†å§ï¼Ÿé‚£æˆ‘ä»¬æ¥çœ‹çœ‹å¦ä¸€ç§å†™æ³•ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">BM_User</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) OptionPermission permission;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<p>æœ‰äººå°±è¦é—®äº†ï¼ŒOptionPermissionæ˜¯ä»€ä¹ˆé¬¼ï¼Ÿæ¥ï¼Œç»§ç»­ã€‚ã€‚ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">æƒé™æšä¸¾</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">- 1: permission1ï¼ŒäºŒè¿›åˆ¶ç¬¬1ä½ï¼Œ0è¡¨ç¤ºå¦ï¼Œ1è¡¨ç¤ºæ˜¯</span></span><br><span class="line"><span class="comment">- 2: permission2ï¼ŒäºŒè¿›åˆ¶ç¬¬2ä½ï¼Œ0è¡¨ç¤ºå¦ï¼Œ1è¡¨ç¤ºæ˜¯</span></span><br><span class="line"><span class="comment">- 4: permission3ï¼ŒäºŒè¿›åˆ¶ç¬¬3ä½ï¼Œ0è¡¨ç¤ºå¦ï¼Œ1è¡¨ç¤ºæ˜¯</span></span><br><span class="line"><span class="comment">- 8: permission4ï¼ŒäºŒè¿›åˆ¶ç¬¬4ä½ï¼Œ0è¡¨ç¤ºå¦ï¼Œ1è¡¨ç¤ºæ˜¯</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">NS_OPTIONS</span>(<span class="built_in">NSUInteger</span>, OptionPermission) &#123;</span><br><span class="line">permission1 = <span class="number">1</span> &lt;&lt; <span class="number">0</span>,<span class="comment">//0001,1</span></span><br><span class="line">permission2 = <span class="number">1</span> &lt;&lt; <span class="number">1</span>,<span class="comment">//0010,2</span></span><br><span class="line">permission3 = <span class="number">1</span> &lt;&lt; <span class="number">2</span>,<span class="comment">//0100,4</span></span><br><span class="line">permission4 = <span class="number">1</span> &lt;&lt; <span class="number">3</span>,<span class="comment">//1000,8</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>é‚£ç”¨æˆ·AåŒæ—¶æ‹¥æœ‰permission1ã€permission2ã€permission4æ€ä¹ˆè¡¨ç¤ºå‘¢ï¼Ÿ<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BM_User *userA = [[BM_User alloc] init];</span><br><span class="line">userA.permission = permission1 | permission2 | permission4;</span><br></pre></td></tr></table></figure></p>
<p>æ˜¯ä¸æ˜¯ç¥æ¸…æ°”çˆ½ï¼Ÿ</p>
<p>ç°åœ¨æˆ‘ä»¬å°±å…·ä½“åŒ–4ç§æƒé™ï¼Œå¹¶ç»™å‡ºåŸºç¡€ä½æ©ç çš„è¡¨è¾¾åŠè¿ç®—ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#ifndef BM_Head_h</span></span><br><span class="line"><span class="meta">#define BM_Head_h</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">æƒé™æšä¸¾</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">- 1: æ˜¯å¦å…è®¸æŸ¥è¯¢ï¼ŒäºŒè¿›åˆ¶ç¬¬1ä½ï¼Œ0è¡¨ç¤ºå¦ï¼Œ1è¡¨ç¤ºæ˜¯</span></span><br><span class="line"><span class="comment">- 2: æ˜¯å¦å…è®¸æ–°å¢ï¼ŒäºŒè¿›åˆ¶ç¬¬2ä½ï¼Œ0è¡¨ç¤ºå¦ï¼Œ1è¡¨ç¤ºæ˜¯</span></span><br><span class="line"><span class="comment">- 4: æ˜¯å¦å…è®¸ä¿®æ”¹ï¼ŒäºŒè¿›åˆ¶ç¬¬3ä½ï¼Œ0è¡¨ç¤ºå¦ï¼Œ1è¡¨ç¤ºæ˜¯</span></span><br><span class="line"><span class="comment">- 8: æ˜¯å¦å…è®¸åˆ é™¤ï¼ŒäºŒè¿›åˆ¶ç¬¬4ä½ï¼Œ0è¡¨ç¤ºå¦ï¼Œ1è¡¨ç¤ºæ˜¯</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">NS_OPTIONS</span>(<span class="built_in">NSUInteger</span>, OptionPermission) &#123;</span><br><span class="line">ALLOW_SELECT = <span class="number">1</span> &lt;&lt; <span class="number">0</span>,<span class="comment">//0001,1</span></span><br><span class="line">ALLOW_INSERT = <span class="number">1</span> &lt;&lt; <span class="number">1</span>,<span class="comment">//0010,2</span></span><br><span class="line">ALLOW_UPDATE = <span class="number">1</span> &lt;&lt; <span class="number">2</span>,<span class="comment">//0100,4</span></span><br><span class="line">ALLOW_DELETE = <span class="number">1</span> &lt;&lt; <span class="number">3</span>,<span class="comment">//1000,8</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#endif /* BM_Head_h */</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"BM_Permission.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"BM_Head.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">BM_Permission</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** å­˜å‚¨ç›®å‰çš„æƒé™çŠ¶æ€ */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) OptionPermission flag;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">BM_Permission</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/** é‡æ–°è®¾ç½®æƒé™ */</span></span><br><span class="line">- (<span class="keyword">void</span>)setPermission:(OptionPermission)permission &#123;</span><br><span class="line"><span class="keyword">self</span>.flag = permission;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** æ·»åŠ ä¸€é¡¹æˆ–å¤šé¡¹æƒé™ */</span></span><br><span class="line">- (<span class="keyword">void</span>)enable:(OptionPermission)permission &#123;</span><br><span class="line"><span class="keyword">self</span>.flag |= permission;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** åˆ é™¤ä¸€é¡¹æˆ–å¤šé¡¹æƒé™ */</span></span><br><span class="line">- (<span class="keyword">void</span>)disable:(OptionPermission)permission &#123;</span><br><span class="line"><span class="keyword">self</span>.flag &amp;= ~permission;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** æ˜¯å¦æ‹¥æŸäº›æƒé™ */</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)siAllow:(OptionPermission)permission &#123;</span><br><span class="line"><span class="keyword">return</span> (<span class="keyword">self</span>.flag &amp; permission) == permission;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** æ˜¯å¦ç¦ç”¨äº†æŸäº›æƒé™ */</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)isNotAllow:(OptionPermission)permission &#123;</span><br><span class="line"><span class="keyword">return</span> (<span class="keyword">self</span>.flag &amp; permission) == <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** æ˜¯å¦ä»…ä»…æ‹¥æœ‰æŸäº›æƒé™ */</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)isOnlyAllow:(OptionPermission)permission &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">self</span>.flag == permission;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="äº”ã€å†™åœ¨æœ€å"><a href="#äº”ã€å†™åœ¨æœ€å" class="headerlink" title="äº”ã€å†™åœ¨æœ€å"></a>äº”ã€å†™åœ¨æœ€å</h3><ul>
<li>å¤§å®¶è¿˜å¯ä»¥è‡ªè¡Œæœç´¢ä¸€ä¸‹NS_OPTIONSä¸NS_ENUMçš„åŒºåˆ«ï¼Œä»–ä»¬éƒ½æ˜¯ç”¨æ¥å®šä¹‰æšä¸¾çš„ï¼Œä½†å…¶ç”¨æ³•æ˜¯æœ‰å¾ˆå¤§ä¸åŒã€‚</li>
<li>åšä¸»æˆ‘æœ€è¿‘ä¸€ç›´åœ¨è€ƒè™‘ä¼˜åŒ–ä»£ç ï¼Œæ­£åœ¨å¼€å‘çš„é¡¹ç›®ä¸­å°±æœ‰å¾ˆå¤šæƒé™åˆ¤æ–­çš„é—®é¢˜ï¼Œæˆ‘ä¹Ÿåœ¨å¯»æ‰¾å„ç§å„æ ·æ›´å¥½çš„å†™æ³•ã€‚</li>
<li>ä¹Ÿå¸Œæœ›å¤§å®¶é‡è§†ä»£ç çš„è¡¨è¾¾ï¼Œå› æ­¤æ›´åŠ ä¼˜åŒ–è‡ªå·±çš„ä»£ç ã€‚</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/08/iOSåˆ†å±‚æ¶æ„è®¾è®¡-å®æˆ˜ç¯‡/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Leewin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Welcome">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/08/iOSåˆ†å±‚æ¶æ„è®¾è®¡-å®æˆ˜ç¯‡/" itemprop="url">iOSåˆ†å±‚æ¶æ„è®¾è®¡-å®æˆ˜ç¯‡</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-08T23:31:12+08:00">
                2018-04-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h3><p>iOSçš„åº”ç”¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ— éå°±æ˜¯ç”¨æˆ·ä¸ç•Œé¢é—´äº¤äº’ï¼Œå½¢æˆæ“ä½œæŒ‡ä»¤ï¼Œç„¶åå¯¹æ•°æ®è¿›è¡Œå¢åˆ æ”¹æŸ¥ã€‚å½“ä¸šåŠ¡è¿‡äºå¤æ‚æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥é‡‡ç”¨åˆ†å±‚æ¶æ„è®¾è®¡ã€‚è¿™æ ·å¯ä»¥æœ€å¤§ç¨‹åº¦ä¸Šè§£è€¦ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬ä¸»è¦ä»‹ç»æœ€ç»å…¸çš„ä¸‰å±‚æ¶æ„è®¾è®¡æ¨¡å‹ã€‚å¤§ä½“ä¸Šï¼Œåˆ†åˆ«ä¸ºï¼šåº”ç”¨å±‚ã€æœåŠ¡å±‚ã€æ•°æ®å±‚ã€‚</p>
<blockquote>
<p>Tips: æˆ‘ä»¬å¸¸ç”¨çš„MVCã€MVPã€MVVMç­‰éƒ½æ˜¯å±äºåº”ç”¨å±‚å†…çš„æ¶æ„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬ä¸»è¦æ˜¯ä¸ºåº”ç”¨å±‚è§£è€¦ç­‰ã€‚è€Œæœ¬æ–‡æåˆ°çš„åˆ†å±‚æ¶æ„æ˜¯é’ˆå¯¹æ•´ä¸ªé¡¹ç›®è€Œè¨€ã€‚</p>
</blockquote>
<h3 id="äºŒã€æ¡ˆä¾‹åˆ†æ"><a href="#äºŒã€æ¡ˆä¾‹åˆ†æ" class="headerlink" title="äºŒã€æ¡ˆä¾‹åˆ†æ"></a>äºŒã€æ¡ˆä¾‹åˆ†æ</h3><p>æœ¬ç¯‡ä¸»è¦ä»¥ä»£ç å®ä¾‹ä¸ºä¸»ï¼Œæˆ‘ä»¬å°†é€šè¿‡ä¸€ä¸ªç®€å•æ¡ˆä¾‹æ¥å±•ç¤ºåˆ†å±‚æ¶æ„è®¾è®¡ã€‚</p>
<p>æ­¤ä¾‹ä¸»è¦æ˜¯æ¨¡æ‹Ÿäº†æ‰“å°æœºè¾“å…¥ç«¯çš„ä¸šåŠ¡é€»è¾‘ã€‚</p>
<p>æˆ‘ä»¬çš„ä¸»è¦ä¸šåŠ¡é€»è¾‘ä¸ºæ‰“å°å’Œå¤å°ï¼Œæµç¨‹æ¡†å›¾å¦‚ä¸‹ï¼šğŸ‘‡ğŸ‘‡ğŸ‘‡</p>
<p><img src="https://upload-images.jianshu.io/upload_images/6544436-ea03b0873def995a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ä¸»è¦é€»è¾‘æµç¨‹æ¡†å›¾.png"></p>
<p>åŸºæœ¬æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ul>
<li><p>ç”¨æˆ·é€‰æ‹©æœåŠ¡ç±»å‹ï¼šæ‰“å°æˆ–è€…å¤å°ï¼Ÿ</p>
</li>
<li><p>å¦‚æœç”¨æˆ·é€‰æ‹©æ‰“å°ï¼Œåˆ™è®©ç”¨æˆ·è¾“å…¥è¦æ‰“å°çš„å†…å®¹ï¼Œè¾“å…¥å®Œæˆåç‚¹å‡»æäº¤ã€‚</p>
</li>
<li><p>å¦‚æœç”¨æˆ·é€‰æ‹©å¤å°ï¼Œåˆ™è®©ç”¨æˆ·æä¾›åŸä»¶ï¼Œæ“ä½œå®Œæˆåç‚¹å‡»æäº¤ã€‚</p>
</li>
<li><p>æäº¤åï¼Œç³»ç»Ÿç”Ÿæˆæ‰“å°è¾“å‡ºé¢„è§ˆï¼Œç”¨æˆ·ç¡®è®¤æ— è¯¯åç‚¹å‡»ç«‹åˆ»æ‰“å°ã€‚</p>
</li>
<li><p>æäº¤æ•°æ®ç»™æ‰“å°æœºï¼Œå¼€å§‹æ‰“å°ã€‚</p>
</li>
</ul>
<h3 id="ä¸‰ã€ä»£ç å®ç°"><a href="#ä¸‰ã€ä»£ç å®ç°" class="headerlink" title="ä¸‰ã€ä»£ç å®ç°"></a>ä¸‰ã€ä»£ç å®ç°</h3><p>é¦–å…ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹ç›®å½•ç»“æ„ğŸ‘‡ğŸ‘‡ğŸ‘‡</p>
<p><img src="https://upload-images.jianshu.io/upload_images/6544436-032dae6ebab7476c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ç›®å½•ç»“æ„.png"></p>
<ul>
<li>åº”ç”¨å±‚ - ApplicationLayer - MVC</li>
</ul>
<blockquote>
<p>æ•°æ®æ¨¡å‹ - Model<br>PrintModel.h<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *content;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>è§†å›¾æ¨¡å‹ - View<br>PrintView<br>CopyView</p>
</blockquote>
<blockquote>
<p>æ§åˆ¶å™¨ - Controller<br>MainController<br>PrintController<br>PreviewController</p>
</blockquote>
<p>è¿™ä¸€å±‚å°±ä¸å¤šè§£é‡Šäº†ï¼Œé‡‡ç”¨é‡ŒMVCæ¶æ„ï¼Œä¸»è¦ç”¨äºä¸ç”¨æˆ·é—´çš„äº¤äº’ï¼Œæ¥æ”¶æ“ä½œæŒ‡ä»¤ç­‰ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">PrintController</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)configClient &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">self</span>.type == OptionPrint) &#123;</span><br><span class="line">[<span class="keyword">self</span> configPrintClient];</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">self</span>.type == OptionCopy) &#123;</span><br><span class="line">[<span class="keyword">self</span> configCopyClient];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)configPrintClient &#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSString</span> *userInput = [<span class="keyword">self</span>.printView getContent];</span><br><span class="line"></span><br><span class="line">PrintModel *model = [[ServiceFactory sharedInstance].printService buildPrintModelWithContent:userInput];</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"æˆ‘è¦æ‰“å°äº† %@"</span>, model);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)configCopyClient &#123;</span><br><span class="line"></span><br><span class="line">PrintModel *model1 = [[ServiceFactory sharedInstance].copyService getCopyPrintModel1];</span><br><span class="line">PrintModel *model2 = [[ServiceFactory sharedInstance].copyService getCopyPrintModel2];</span><br><span class="line">PrintModel *model3 = [[ServiceFactory sharedInstance].copyService getCopyPrintModel3];</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"æˆ‘è¦å¤å°äº† %@ \n %@ \n %@"</span>, model1, model2, model3);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>æœåŠ¡å±‚ - ServiceLayer</li>
</ul>
<p>æ­¤å±‚çš„æ‰€æœ‰æœåŠ¡ç”±ServiceFactoryæ¥åŒä¸€è°ƒé…ã€‚ServiceFactoryæ˜¯ä¸€ä¸ªå•ä¾‹ï¼ŒæŒæœ‰æœåŠ¡å±‚çš„æ‰€æœ‰æœåŠ¡ã€‚ç”±æœåŠ¡å±‚æ¥æ¥è§¦æ•°æ®å±‚ã€‚åº”ç”¨å±‚åˆ™æ¥è§¦æœåŠ¡å±‚ã€‚</p>
<p>æ­¤å¤„åŒ…å«äº†ä¸¤ä¸ªæœåŠ¡ï¼šæ‰“å°æœåŠ¡ï¼ˆPrintServiceï¼‰å’Œå¤å°æœåŠ¡ï¼ˆCopyServiceï¼‰<br>æ³¨ï¼šå¦‚æœåç»­æœ‰æ–°çš„æœåŠ¡ï¼Œåˆ™åªéœ€è¦åœ¨ServiceFactoryä¸­æ³¨å†Œä¸€ä¸‹å³å¯ã€‚</p>
<blockquote>
<p>ServiceFactory<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"PrintService.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"CopyService.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ServiceFactory</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">instancetype</span>)sharedInstance;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) PrintService *printService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) CopyService *copyService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
</blockquote>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"ServiceFactory.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ServiceFactory</span></span></span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">instancetype</span>)sharedInstance &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> ServiceFactory *instance = <span class="literal">nil</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</span><br><span class="line"><span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</span><br><span class="line">instance = [ServiceFactory new];</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">return</span> instance;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">instancetype</span>)init &#123;</span><br><span class="line"><span class="keyword">self</span> = [<span class="keyword">super</span> init];</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">[<span class="keyword">self</span> configFoundation];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)configFoundation &#123;</span><br><span class="line"><span class="keyword">self</span>.printService = [PrintService new];</span><br><span class="line"><span class="keyword">self</span>.copyService = [CopyService new];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>PrintService<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@class</span> <span class="title">PrintModel</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">PrintService</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line">- (PrintModel *)buildPrintModelWithContent:(<span class="built_in">NSString</span> *)content;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
</blockquote>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"PrintService.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"DataAccessFactory.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">PrintService</span></span></span><br><span class="line"></span><br><span class="line">- (PrintModel *)buildPrintModelWithContent:(<span class="built_in">NSString</span> *)content &#123;</span><br><span class="line">PrintModel *model = [[DataAccessFactory sharedInstance].printDao buildPrintModelWithContent:content];</span><br><span class="line"><span class="keyword">return</span> model;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>CopyService</p>
</blockquote>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@class</span> <span class="title">PrintModel</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">CopyService</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line">- (PrintModel *)getCopyPrintModel1;</span><br><span class="line"></span><br><span class="line">- (PrintModel *)getCopyPrintModel2;</span><br><span class="line"></span><br><span class="line">- (PrintModel *)getCopyPrintModel3;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"CopyService.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"DataAccessFactory.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">CopyService</span></span></span><br><span class="line"></span><br><span class="line">- (PrintModel *)getCopyPrintModel1 &#123;</span><br><span class="line">PrintModel *model = [[DataAccessFactory sharedInstance].copyDao getCopyPrintModel1];</span><br><span class="line"><span class="keyword">return</span> model;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (PrintModel *)getCopyPrintModel2 &#123;</span><br><span class="line">PrintModel *model = [[DataAccessFactory sharedInstance].copyDao getCopyPrintModel2];</span><br><span class="line"><span class="keyword">return</span> model;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (PrintModel *)getCopyPrintModel3 &#123;</span><br><span class="line">PrintModel *model = [[DataAccessFactory sharedInstance].copyDao getCopyPrintModel3];</span><br><span class="line"><span class="keyword">return</span> model;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<ul>
<li>æ•°æ®å±‚ - DataAccessLayer</li>
</ul>
<p>æ­¤å±‚ç”±DataAccessFactoryæ¥åŒä¸€è°ƒé…ã€‚DataAccessFactoryæ˜¯ä¸€ä¸ªå•ä¾‹ï¼ŒæŒæœ‰æ•°æ®å±‚çš„æ‰€æœ‰èµ„æºã€‚ç”±æ•°æ®å±‚æ¥ç›´æ¥æ¥è§¦æ•°æ®ã€‚</p>
<p>æ­¤å¤„åŒ…å«äº†ä¸¤ä¸ªæ•°æ®èµ„æºï¼šæ‰“å°ï¼ˆPrintDAOï¼‰å’Œå¤å°ï¼ˆCopyDAOï¼‰<br>æ³¨ï¼šå¦‚æœåç»­æœ‰æ–°çš„æ•°æ®å±‚ï¼Œåˆ™åªéœ€è¦åœ¨DataAccessFactoryä¸­æ³¨å†Œä¸€ä¸‹å³å¯ã€‚</p>
<blockquote>
<p>DataAccessFactory<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"PrintDAO.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"CopyDAO.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">DataAccessFactory</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">instancetype</span>)sharedInstance;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) PrintDAO *printDao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) CopyDAO *copyDao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
</blockquote>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"DataAccessFactory.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">DataAccessFactory</span></span></span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">instancetype</span>)sharedInstance &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> DataAccessFactory *instance = <span class="literal">nil</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</span><br><span class="line"><span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</span><br><span class="line">instance = [DataAccessFactory new];</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">return</span> instance;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">instancetype</span>)init &#123;</span><br><span class="line"><span class="keyword">self</span> = [<span class="keyword">super</span> init];</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">[<span class="keyword">self</span> configFoundation];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)configFoundation &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">self</span>.printDao = [PrintDAO new];</span><br><span class="line"></span><br><span class="line"><span class="keyword">self</span>.copyDao = [CopyDAO new];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>PrintDAO<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@class</span> <span class="title">PrintModel</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">PrintDAO</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line">- (PrintModel *)buildPrintModelWithContent:(<span class="built_in">NSString</span> *)content;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
</blockquote>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"PrintDAO.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"PrintModel.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">PrintDAO</span></span></span><br><span class="line"></span><br><span class="line">- (PrintModel *)buildPrintModelWithContent:(<span class="built_in">NSString</span> *)content &#123;</span><br><span class="line">PrintModel *model = [[PrintModel alloc] init];</span><br><span class="line">model.content = content;</span><br><span class="line"><span class="keyword">return</span> model;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>CopyDAO<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@class</span> <span class="title">PrintModel</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">CopyDAO</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line">- (PrintModel *)getCopyPrintModel1;</span><br><span class="line"></span><br><span class="line">- (PrintModel *)getCopyPrintModel2;</span><br><span class="line"></span><br><span class="line">- (PrintModel *)getCopyPrintModel3;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
</blockquote>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"CopyDAO.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"PrintModel.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">CopyDAO</span></span></span><br><span class="line"></span><br><span class="line">- (PrintModel *)getCopyPrintModel1 &#123;</span><br><span class="line">PrintModel *model = [[PrintModel alloc] init];</span><br><span class="line">model.content = <span class="string">@"Hello world"</span>;</span><br><span class="line"><span class="keyword">return</span> model;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (PrintModel *)getCopyPrintModel2 &#123;</span><br><span class="line">PrintModel *model = [[PrintModel alloc] init];</span><br><span class="line">model.content = <span class="string">@"Where there is a will, there is a way"</span>;</span><br><span class="line"><span class="keyword">return</span> model;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (PrintModel *)getCopyPrintModel3 &#123;</span><br><span class="line">PrintModel *model = [[PrintModel alloc] init];</span><br><span class="line">model.content = <span class="string">@"We will, we will rock you"</span>;</span><br><span class="line"><span class="keyword">return</span> model;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<h3 id="å››ã€ç»“è®ºåˆ†æ"><a href="#å››ã€ç»“è®ºåˆ†æ" class="headerlink" title="å››ã€ç»“è®ºåˆ†æ"></a>å››ã€ç»“è®ºåˆ†æ</h3><ul>
<li><p>åˆ†å±‚æ¶æ„è®¾è®¡æœ€æ˜æ˜¾çš„ç‰¹ç‚¹å°±æ˜¯ï¼Œç»“æ„åˆ†å±‚ï¼Œä¸”ä¸å¯è·¨å±‚è®¿é—®ï¼Œæ¯”å¦‚ï¼Œåº”ç”¨å±‚ä¸èƒ½ç›´æ¥è®¿é—®æ•°æ®ï¼Œä»…æœ‰æ•°æ®å±‚èƒ½ç›´æ¥æ“ä½œæ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåº”ç”¨å±‚å¿…é¡»å…ˆç»ç”±æœåŠ¡å±‚è®¿é—®æ•°æ®å±‚ï¼Œå†ç”±æ•°æ®å±‚æ“ä½œæ•°æ®ã€‚è¿™æ ·æœ‰äººå°±è¦é—®äº†ï¼Œä¸ºä»€ä¹ˆè¦è¿™ä¹ˆå¤æ‚ï¼Ÿåœ¨åº”ç”¨å±‚å¯¼å…¥PrintModel.hï¼Œç›´æ¥æ“ä½œä¸å°±è¡Œäº†ï¼Ÿ</p>
</li>
<li><p>å½“ç„¶æ˜¯è¡Œçš„ï¼Œä¸€æ ·å¯ä»¥è¾¾åˆ°æ•ˆæœï¼Œä½†æ˜¯ï¼Œå¦‚æœä¸šåŠ¡é€»è¾‘å‘ç”Ÿå˜åŠ¨æˆ–æ–°å¢é€»è¾‘ï¼Œæˆ‘ä»¬å°±å¿…é¡»ä¿®æ”¹æˆ–é‡å†™åº”ç”¨å±‚ï¼Œè¿™æ˜¯æˆ‘ä»¬æœ€ä¸æ„¿çœ‹åˆ°çš„ï¼Œå†æˆ–è€…ï¼Œå¦ä¸€ä¸ªæ¨¡å—ä¹Ÿè¦ç”¨åˆ°ç±»ä¼¼çš„ä¸šåŠ¡é€»è¾‘ï¼Œæ¯”å¦‚æœ‰äº†ä¸€å°é«˜çº§æ‰“å°æœºï¼Œåœ¨æ‰“å°å’Œå¤å°åŠŸèƒ½ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œé‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯è¦å†å¤åˆ¶ä¸€ä»½æ™®é€šæ‰“å°æœºåº”ç”¨å±‚çš„é€»è¾‘å‘¢ï¼Ÿè¿™äº›éƒ½æ˜¯å¾ˆä¸¥é‡çš„é—®é¢˜ã€‚</p>
</li>
<li><p>ä»è¿™é‡Œï¼Œæˆ‘ä»¬ä¸éš¾çœ‹å‡ºï¼Œé¦–å…ˆæˆ‘ä»¬æ˜¯å°†å¯è§ä¸ä¸å¯è§åˆ†å±‚ï¼Œå†å°†å…¬ç”¨çš„å½¢æˆæ¨¡å—æ²‰åº•ï¼Œä½¿æ¯å±‚é—´èƒ½ç›¸äº’ç‹¬ç«‹ï¼Œæœ‰æ¸…æ™°çš„ä¾èµ–å…³ç³»ï¼Œè¿™å°±æ˜¯åˆ†å±‚æ¶æ„çš„ç›®çš„ã€‚</p>
</li>
</ul>
<h3 id="äº”ã€å†™åœ¨æœ€å"><a href="#äº”ã€å†™åœ¨æœ€å" class="headerlink" title="äº”ã€å†™åœ¨æœ€å"></a>äº”ã€å†™åœ¨æœ€å</h3><p>è¿™æ ·ä¸€ä¸ªç®€å•çš„æ¡ˆä¾‹è‚¯å®šä¸èƒ½å®Œæˆçš„è¦†ç›–åˆ†å±‚æ¶æ„ï¼Œä½†å·²ç»æ˜ç¡®çš„ä½“ç°äº†åˆ†å±‚æ¶æ„çš„æ ¸å¿ƒï¼Œåœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬è¦æ ¹æ®å®é™…çš„ä¸šåŠ¡é€»è¾‘æ¥å®šä¹‰æœåŠ¡å±‚å’Œæ•°æ®å±‚ï¼Œåº”ç”¨å±‚åŸºæœ¬é€šç”¨ã€‚çœ‹ä¼¼ç®€å•ï¼Œä½†éœ€è¦å¤§é‡çš„å®æˆ˜ç»éªŒæ‰èƒ½å®Œç¾å¸æ”¶ï¼Œä¹Ÿå¸Œæœ›è¯»è€…èƒ½å¤šåŠ¨æ‰‹ã€‚</p>
<ul>
<li>æœ‰éœ€è¦æºç çš„å¯ä»¥è”ç³»æˆ‘~</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/04/iOSåˆ†å±‚æ¶æ„è®¾è®¡-ä»‹ç»ç¯‡/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Leewin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Welcome">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/04/iOSåˆ†å±‚æ¶æ„è®¾è®¡-ä»‹ç»ç¯‡/" itemprop="url">iOSåˆ†å±‚æ¶æ„è®¾è®¡-ä»‹ç»ç¯‡</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-04T22:55:58+08:00">
                2018-03-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h3><p>iOSçš„åº”ç”¨ä¹Ÿéœ€è¦æ¶æ„è®¾è®¡å—ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œä½†æ˜¯å¹¶ä¸ä¸€å®šé‡‡ç”¨åˆ†å±‚æ¶æ„è®¾è®¡ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæœ‰å…³ä¿¡æ¯å¤„ç†çš„åº”ç”¨é‡‡ç”¨åˆ†å±‚æ¶æ„è®¾è®¡ï¼Œè€Œæ¸¸æˆç­‰åº”ç”¨ä¸ä¼šé‡‡ç”¨åˆ†å±‚æ¶æ„è®¾è®¡ã€‚</p>
<blockquote>
<p>Tipsï¼šæ¸¸æˆå¼€å‘ä¸€èˆ¬éƒ½ä¼šé‡‡ç”¨æŸä¸ªå¼•æ“ï¼Œæ¸¸æˆå¼•æ“äº‹å®ä¸ŠåŒ…å«é‡Œæ¶æ„è®¾è®¡è§£å†³æ–¹æ¡ˆï¼Œæ¸¸æˆå¼•æ“çš„æ¶æ„ä¸€èˆ¬ä¸æ˜¯åˆ†å±‚çš„è€Œæ˜¯æ ‘å½¢ç»“æ„çš„ã€‚</p>
</blockquote>
<ul>
<li>è¡¨ç¤ºå±‚ï¼šå®ƒç”±UIKit Frameworkæ„æˆï¼ŒåŒ…æ‹¬è§†å›¾ã€æ§åˆ¶å™¨ã€æ§ä»¶å’Œäº‹ä»¶å¤„ç†ç­‰ã€‚</li>
<li>ä¸šåŠ¡é€»è¾‘å±‚ï¼šæ¡†æ¶çš„é€‰å–æ˜¯æ ¹æ®ä¸šåŠ¡è€Œå®šï¼Œä½†ä¸€èˆ¬æ˜¯å…·æœ‰ä¸€å®šä¸šåŠ¡å¤„ç†åŠŸèƒ½çš„ç¼–ç¨‹è¯­è¨€å°è£…çš„ç±»æˆ–å‡½æ•°ã€‚</li>
<li>æ•°æ®æŒæœ‰å±‚ï¼šæä¾›æœ¬åœ°å’Œç½‘ç»œæ•°æ®è®¿é—®ï¼Œå®ƒå¯èƒ½æ˜¯è®¿é—®SQLiteæ•°æ®çš„APIå‡½æ•°ï¼Œä¹Ÿå¯èƒ½æ˜¯Core DataæŠ€æœ¯ï¼Œæˆ–æ˜¯è®¿é—®æ–‡ä»¶çš„NSFileManagerï¼Œæˆ–æ˜¯ç½‘ç»œé€šä¿¡æŠ€æœ¯ã€‚</li>
<li>ä¿¡æ¯ç³»ç»Ÿå±‚ï¼šå®ƒçš„ä¿¡æ¯æ¥æºåˆ†ä¸ºæœ¬åœ°å’Œç½‘ç»œã€‚æœ¬åœ°æ•°æ®å¯ä»¥æ”¾å…¥æ–‡ä»¶ä¸­ï¼Œä¹Ÿå¯ä»¥æ”¾å…¥æ•°æ®åº“ä¸­ï¼Œç›®å‰iOSæœ¬åœ°æ•°æ®åº“é‡‡ç”¨SQLite3ã€‚ç½‘ç»œå¯ä»¥æ˜¯æŸä¸ªäº‘æœåŠ¡ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€èˆ¬çš„WebæœåŠ¡ã€‚</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/6544436-7245318f8bbcc8d2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å›¾1:åˆ†å±‚æ¶æ„è®¾è®¡å›¾"></p>
<h3 id="äºŒã€å·¥ç¨‹ä¸å·¥ä½œç©ºé—´"><a href="#äºŒã€å·¥ç¨‹ä¸å·¥ä½œç©ºé—´" class="headerlink" title="äºŒã€å·¥ç¨‹ä¸å·¥ä½œç©ºé—´"></a>äºŒã€å·¥ç¨‹ä¸å·¥ä½œç©ºé—´</h3><p>Xcodeä¸ä»…å¯ä»¥åˆ›å»ºå·¥ç¨‹ï¼ˆProjectï¼‰ï¼Œè¿˜å¯ä»¥åˆ›å»ºå·¥ä½œç©ºé—´ï¼ˆWorkspaceï¼‰ã€‚å‡ºäºæ–¹ä¾¿ç®¡ç†ç­‰ç›®çš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†å¤šä¸ªç›¸äº’ç®¡ç†çš„å·¥ç¨‹æ”¾åˆ°ä¸€ä¸ªå·¥ä½œç©ºé—´ä¸­ï¼Œå·¥ä½œç©ºé—´æ˜¯å¤šä¸ªå·¥ç¨‹çš„é›†åˆã€‚å·¥ç¨‹æ–‡ä»¶åçš„åç¼€æ˜¯.xcodeprojï¼Œå·¥ä½œç©ºé—´æ–‡ä»¶åçš„åç¼€æ˜¯.xcworkspaceã€‚</p>
<h3 id="ä¸‰ã€é™æ€é“¾æ¥åº“"><a href="#ä¸‰ã€é™æ€é“¾æ¥åº“" class="headerlink" title="ä¸‰ã€é™æ€é“¾æ¥åº“"></a>ä¸‰ã€é™æ€é“¾æ¥åº“</h3><p>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å°†æŸä¸€å±‚å¤ç”¨ç»™å…¶ä»–å›¢é˜Ÿã€å…¬å¸æˆ–ä¸ªäººï¼Œä½†ç”±äºæŸäº›åŸå› ï¼Œæˆ‘ä»¬ä¸èƒ½æä¾›æºä»£ç ï¼Œæ­¤æ—¶å°±å¯ä»¥å°†ä¸šåŠ¡é€»è¾‘å±‚å’Œæ•°æ®æŒæœ‰å±‚ç¼–å†™æˆé™æ€é“¾æ¥åº“ï¼ˆstatic library æˆ– static-linked libraryï¼‰æˆ–æ¡†æ¶ï¼ˆFrameworkï¼‰ã€‚<br>åº“æ˜¯ä¸€äº›æ²¡æœ‰mainå‡½æ•°çš„ç¨‹åºä»£ç çš„é›†åˆã€‚é™¤äº†é™æ€é“¾æ¥åº“ï¼Œè¿˜æœ‰åŠ¨æ€é“¾æ¥åº“ã€‚å®ƒä»¬çš„åŒºåˆ«æ˜¯ï¼šé™æ€é“¾æ¥åº“å¯ä»¥ç¼–è¯‘åˆ°ä½ çš„æ‰§è¡Œä»£ç ä¸­ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥åœ¨æ²¡æœ‰é™æ€é“¾æ¥åº“çš„ç¯å¢ƒä¸‹è¿è¡Œï¼›åŠ¨æ€é“¾æ¥åº“ä¸èƒ½ç¼–è¯‘åˆ°ä½ çš„æ‰§è¡Œä»£ç ä¸­ï¼Œåº”ç”¨ç¨‹åºå¿…é¡»åœ¨æœ‰é“¾æ¥åº“æ–‡ä»¶çš„ç¯å¢ƒä¸‹è¿è¡Œã€‚<br>åœ¨Xcodeä¸­å¯ä»¥åˆ›å»ºé™æ€é“¾æ¥åº“å·¥ç¨‹ï¼Œå…·ä½“è¿‡ç¨‹å¦‚ä¸‹ï¼š<br>File -&gt; New -&gt; Project - &gt; â€¦<br>Framework &amp; Library -&gt; Cocoa Touch Static Libraryå·¥ç¨‹æ¨¡æ¿ã€‚å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/6544436-995ae4709a910cab.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å›¾2:åˆ›å»ºé™æ€é“¾æ¥åº“å·¥ç¨‹"></p>
<blockquote>
<p>Tips:é™æ€é“¾æ¥åº“ä¸­ä¸èƒ½æœ‰Swiftä»£ç æ¨¡å—ï¼Œåªèƒ½æ˜¯Objective-Cä»£ç æ¨¡å—ã€‚</p>
</blockquote>
<h3 id="å››ã€æ¡†æ¶"><a href="#å››ã€æ¡†æ¶" class="headerlink" title="å››ã€æ¡†æ¶"></a>å››ã€æ¡†æ¶</h3><p>ç”±äºé™æ€é“¾æ¥åº“æ¯”è¾ƒéº»çƒ¦ï¼Œéœ€è¦ç»™å¼€å‘è€…æä¾›.aå’Œ.hæ–‡ä»¶ï¼Œä½¿ç”¨çš„æ—¶å€™è¿˜è¦é…ç½®å¾ˆå¤šçš„ç¯å¢ƒå˜é‡ã€‚äº‹å®ä¸Šï¼Œè‹¹æœæä¾›çš„APIï¼ˆå¦‚UIKitã€QuartzCoreFoundationï¼‰éƒ½æ˜¯æ¡†æ¶ã€‚ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œæ¡†æ¶ä¼šå°†.aæˆ–.hç­‰æ–‡ä»¶æ‰“åŒ…åœ¨ä¸€èµ·ã€‚<br>åœ¨Xcodeä¸­å¯ä»¥åˆ›å»ºæ¡†æ¶ï¼Œå…·ä½“è¿‡ç¨‹å¦‚ä¸‹ï¼š<br>File -&gt; New -&gt; Project - &gt; â€¦<br>Framework &amp; Library -&gt; Cocoa Touch Framework</p>
<blockquote>
<p>Tips:è‡ªå®šä¹‰æ¡†æ¶æ²¡æœ‰é™æ€é“¾æ¥åº“çš„é™åˆ¶ï¼ŒSwiftä»£ç å¯ä»¥åœ¨æ¡†æ¶å·¥ç¨‹ä¸­ä½¿ç”¨ã€‚</p>
</blockquote>
<h3 id="äº”ã€10ç§åˆ†å±‚æ¨¡å¼"><a href="#äº”ã€10ç§åˆ†å±‚æ¨¡å¼" class="headerlink" title="äº”ã€10ç§åˆ†å±‚æ¨¡å¼"></a>äº”ã€10ç§åˆ†å±‚æ¨¡å¼</h3><p>ç”±äºiOS 8 ä¹‹åå¯ä»¥ä½¿ç”¨Swiftå’ŒObjective-Cä¸¤ç§è¯­è¨€ï¼Œå¼€å‘äººå‘˜éƒ½æœ‰å››ç§æ–¹å¼æ¥é€‰æ‹©å¼€å‘è¯­è¨€ã€‚</p>
<ul>
<li>é‡‡ç”¨çº¯Swiftçš„æ”¹é©æ´¾æ–¹å¼</li>
<li>é‡‡ç”¨çº¯Objective-Cçš„ä¿å®ˆæ´¾æ–¹å¼</li>
<li>é‡‡ç”¨Swiftè°ƒç”¨Objective-Cçš„å·¦å€¾æ”¹è‰¯æ´¾</li>
<li>é‡‡ç”¨Objective-Cè°ƒç”¨Swiftçš„å³å€¾æ”¹è‰¯æ´¾</li>
</ul>
<p>ä»æŠ€æœ¯ä¸Šè®²ï¼Œæ— è®ºæ˜¯å¦é‡‡ç”¨åˆ†å±‚æ¶æ„è®¾è®¡ï¼Œéƒ½å¯ä»¥ç”¨ä¸Šè¿°4ç§æ–¹å¼æ¥é€‰æ‹©è¯­è¨€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥åœ¨åŒä¸€å±‚ä¸­é‡‡ç”¨å•ä¸€è¯­è¨€å’Œæ­é…æ··åˆï¼Œä¹Ÿå¯ä»¥åœ¨ä¸åŒå±‚ä¹‹é—´é‡‡ç”¨å•ä¸€è¯­è¨€å’Œæ­é…æ··åˆã€‚åŸºäºå›¾1è¿›è¡Œåˆ†å±‚ï¼Œå¦‚æœåªè€ƒè™‘ä¸šåŠ¡é€»è¾‘å±‚å’Œæ•°æ®æŒæœ‰å±‚é‡‡ç”¨ç›¸åŒè¯­è¨€çš„æƒ…å†µä¸‹ï¼Œé‚£ä¹ˆå¯ä»¥æ··åˆæ­é…å‡º4ç§æ¨¡å¼ï¼Œå…·ä½“å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/6544436-6e342241ab5f9ca1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å›¾3:4ç§æ··åˆæ­é…"></p>
<p>å¦å¤–ï¼Œå¦‚æœè€ƒè™‘åˆ°ä»£ç çš„ç»„ç»‡å½¢å¼ï¼Œå¯ä»¥åˆ†ä¸ºå¦‚ä¸‹3ç§ï¼š</p>
<ul>
<li>åŒä¸€å·¥ç¨‹çš„åˆ†å±‚ï¼Œç”¨Pï¼ˆProjectï¼‰è¡¨ç¤º</li>
<li>åŸºäºé™æ€é“¾æ¥åº“å®ç°çš„åŒä¸€ä¸ªå·¥ä½œç©ºé—´ä¸åŒå·¥ç¨‹çš„åˆ†å±‚ï¼Œç”¨WLï¼ˆWorkspace Libraryï¼‰è¡¨ç¤º</li>
<li>åŸºäºè‡ªå®šä¹‰æ¡†æ¶å®ç°çš„åŒä¸€ä¸ªå·¥ä½œç©ºé—´ä¸åŒå·¥ç¨‹çš„åˆ†å±‚ï¼Œç”¨WFï¼ˆWorkspace Frameworkï¼‰è¡¨ç¤º</li>
</ul>
<p>ç»„åˆåå¾—å‡ºå¦‚ä¸‹å›¾10ç§åˆ†å±‚æ¨¡å¼</p>
<p><img src="http://upload-images.jianshu.io/upload_images/6544436-3b75d604d48f601b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å›¾4:10ç§åˆ†å±‚æ¨¡å¼"></p>
<p>ç”±äºæ¡†æ¶å®ç°è¦å…ˆè¿›äºé™æ€é“¾æ¥åº“å®ç°ï¼Œæ‰€ä»¥WFOOOã€WFSSSã€WFSOOå’ŒWFOSSæ˜¯æˆ‘ä»¬ä¼˜å…ˆè€ƒè™‘çš„ï¼Œå¦‚æœä»æŠ€æœ¯å’Œè®¾è®¡ä¸Šæ— æ³•å®ç°ï¼Œå¯ä»¥è€ƒè™‘WLOOOå’ŒWLSOOï¼Œæœ€åæ˜¯POOOã€PSSSã€PSOOå’ŒPOSSå®ç°ã€‚</p>
<h3 id="å…­ã€å†™åœ¨æœ€å"><a href="#å…­ã€å†™åœ¨æœ€å" class="headerlink" title="å…­ã€å†™åœ¨æœ€å"></a>å…­ã€å†™åœ¨æœ€å</h3><p>æœ¬æœŸä¸»è¦ä»¥ä»‹ç»ä¸ºä¸»ï¼Œä¸‹ä¸€æœŸå°†æ›´æ–°å®æˆ˜ç¯‡ï¼Œä¼šä»¥å…·ä½“çš„é¡¹ç›®ä¸ºä¸»ä½“ï¼Œè¯¦ç»†è§£æå¦‚ä½•ä½¿ç”¨åˆ†å±‚æ¶æ„ã€‚</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/04/iOSå¼€å‘-å…³äºAssociated-Objects/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Leewin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Welcome">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/04/iOSå¼€å‘-å…³äºAssociated-Objects/" itemprop="url">iOSå¼€å‘-å…³äºAssociated Objects</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-02-04T20:45:41+08:00">
                2018-02-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h3><p>Associated Objects(å…³è”å¯¹è±¡)æ˜¯ä»€ä¹ˆï¼Ÿä»€ä¹ˆæ—¶å€™ç”¨ï¼Ÿä¸ºä»€ä¹ˆè¦ç”¨ï¼Ÿæ€ä¹ˆç”¨ï¼Ÿ<br>æœ€å¼€å§‹ç”¨åˆ°å…³è”å¯¹è±¡æ˜¯æºäºä¸€ä¸ªéœ€æ±‚ï¼ˆåºŸè¯ï¼Œè‚¯å®šæ˜¯æºäºéœ€æ±‚ï¼‰ã€‚<br>å¤§å®¶éƒ½çŸ¥é“ï¼ŒButtonçš„ç‚¹å‡»äº‹ä»¶ï¼Œä¸€å®šæ˜¯å°†æœ¬èº«ä¼ å…¥å‚æ•°ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)setupFoundationUI &#123;</span><br><span class="line"><span class="built_in">UIButton</span> *btn = [<span class="built_in">UIButton</span> buttonWithType:<span class="built_in">UIButtonTypeSystem</span>];</span><br><span class="line">btn.frame = (<span class="built_in">CGRect</span>)&#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">30</span>, <span class="number">30</span>&#125;;</span><br><span class="line">[<span class="keyword">self</span>.view addSubview:btn];</span><br><span class="line">[btn addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(btnDidClick:) forControlEvents:<span class="built_in">UIControlEventTouchUpInside</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)btnDidClick:(<span class="built_in">UIButton</span> *)sender &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"Btn did click ..."</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å¦‚æœæƒ³è¦ä¼ å…¥ä¸€ä¸ªç‰¹å®šçš„å‚æ•°å‘¢ï¼Ÿ</p>
<ul>
<li>å½“æ—¶æˆ‘æƒ³ä¼ çš„å‚æ•°æ˜¯æ•´å‹ï¼Œäºæ˜¯æˆ‘æƒ³åˆ°äº†tagï¼ˆé‚£æ—¶çš„æˆ‘è¿˜ä¸çŸ¥é“å…³è”å¯¹è±¡ï¼‰</li>
<li>tagå…¶å®æ˜¯ç”¨æ¥æ ‡è®°ä¸åŒçš„Buttonå¯¹è±¡ï¼Œä½†æ­¤æ—¶ï¼Œæˆ‘ä¹Ÿå¾ˆæ— å¥ˆã€‚ã€‚ã€‚å°±å…ˆå€Ÿç”¨ä¸€ä¸‹å§ï¼Œå“ˆå“ˆ<br>ä¹Ÿå°±æ˜¯è¿™æ ·ğŸ‘‡ğŸ‘‡ğŸ‘‡<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)setupFoundationUI &#123;</span><br><span class="line"><span class="built_in">UIButton</span> *btn = [<span class="built_in">UIButton</span> buttonWithType:<span class="built_in">UIButtonTypeSystem</span>];</span><br><span class="line">btn.frame = (<span class="built_in">CGRect</span>)&#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">30</span>, <span class="number">30</span>&#125;;</span><br><span class="line">btn.tag = <span class="number">110</span>;</span><br><span class="line">[<span class="keyword">self</span>.view addSubview:btn];</span><br><span class="line">[btn addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(btnDidClick:) forControlEvents:<span class="built_in">UIControlEventTouchUpInside</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)btnDidClick:(<span class="built_in">UIButton</span> *)sender &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"Btn did click ...tag = %zd"</span>, sender.tag);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>åæ¥åˆæœ‰éœ€æ±‚ï¼Œè¦ä¼ çš„å‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œç”šè‡³æ˜¯å¯¹è±¡ã€‚ã€‚ã€‚<br>å°±åœ¨æ­¤æ—¶æˆ‘æ³¨æ„åˆ°äº†å…³è”å¯¹è±¡ï¼ˆAssociated Objectsï¼‰</p>
<h3 id="äºŒã€å…³è”å¯¹è±¡çš„ä»‹ç»"><a href="#äºŒã€å…³è”å¯¹è±¡çš„ä»‹ç»" class="headerlink" title="äºŒã€å…³è”å¯¹è±¡çš„ä»‹ç»"></a>äºŒã€å…³è”å¯¹è±¡çš„ä»‹ç»</h3><h4 id="1-å…³è”å¯¹è±¡è§£å†³çš„é—®é¢˜"><a href="#1-å…³è”å¯¹è±¡è§£å†³çš„é—®é¢˜" class="headerlink" title="1.å…³è”å¯¹è±¡è§£å†³çš„é—®é¢˜"></a>1.å…³è”å¯¹è±¡è§£å†³çš„é—®é¢˜</h4><p>æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨ Objective-C ä¸­å¯ä»¥é€šè¿‡ Category (ç±»åˆ«ã€åˆ†ç±»ï¼Œåæ­£ä½ ä»¬æ‡‚å¾—)ç»™ä¸€ä¸ªç°æœ‰çš„ç±»æ·»åŠ å±æ€§ï¼Œä½†æ˜¯å´ä¸èƒ½æ·»åŠ å®ä¾‹å˜é‡ï¼Œè¿™ä¼¼ä¹æˆä¸ºäº† Objective-C çš„ä¸€ä¸ªæ˜æ˜¾çŸ­æ¿ï¼Œå…³è”å¯¹è±¡å°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<h4 id="2-å¦‚ä½•ç”¨å…³è”å¯¹è±¡"><a href="#2-å¦‚ä½•ç”¨å…³è”å¯¹è±¡" class="headerlink" title="2.å¦‚ä½•ç”¨å…³è”å¯¹è±¡"></a>2.å¦‚ä½•ç”¨å…³è”å¯¹è±¡</h4><ul>
<li><p>é¦–å…ˆè¦å¼•å…¥ runtime</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#import &lt;objc/runtime.h&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>APIä¸»è¦å°±æ˜¯(æ¥è‡ªç³»ç»Ÿæ–‡ä»¶runtime.hçš„ä»‹ç»)ğŸ‘‡ğŸ‘‡ğŸ‘‡</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment">* Sets an associated value for a given object using a given key and association policy.</span></span><br><span class="line"><span class="comment">* </span></span><br><span class="line"><span class="comment">* @param object The source object for the association.</span></span><br><span class="line"><span class="comment">* @param key The key for the association.</span></span><br><span class="line"><span class="comment">* @param value The value to associate with the key key for object. Pass nil to clear an existing association.</span></span><br><span class="line"><span class="comment">* @param policy The policy for the association. For possible values, see â€œAssociative Object Behaviors.â€</span></span><br><span class="line"><span class="comment">* </span></span><br><span class="line"><span class="comment">* @see objc_setAssociatedObject</span></span><br><span class="line"><span class="comment">* @see objc_removeAssociatedObjects</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">OBJC_EXPORT <span class="keyword">void</span></span><br><span class="line">objc_setAssociatedObject(<span class="keyword">id</span> _Nonnull object, <span class="keyword">const</span> <span class="keyword">void</span> * _Nonnull key,</span><br><span class="line"><span class="keyword">id</span> _Nullable value, objc_AssociationPolicy policy)</span><br><span class="line">OBJC_AVAILABLE(<span class="number">10.6</span>, <span class="number">3.1</span>, <span class="number">9.0</span>, <span class="number">1.0</span>, <span class="number">2.0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment">* Returns the value associated with a given object for a given key.</span></span><br><span class="line"><span class="comment">* </span></span><br><span class="line"><span class="comment">* @param object The source object for the association.</span></span><br><span class="line"><span class="comment">* @param key The key for the association.</span></span><br><span class="line"><span class="comment">* </span></span><br><span class="line"><span class="comment">* @return The value associated with the key \e key for \e object.</span></span><br><span class="line"><span class="comment">* </span></span><br><span class="line"><span class="comment">* @see objc_setAssociatedObject</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">OBJC_EXPORT <span class="keyword">id</span> _Nullable</span><br><span class="line">objc_getAssociatedObject(<span class="keyword">id</span> _Nonnull object, <span class="keyword">const</span> <span class="keyword">void</span> * _Nonnull key)</span><br><span class="line">OBJC_AVAILABLE(<span class="number">10.6</span>, <span class="number">3.1</span>, <span class="number">9.0</span>, <span class="number">1.0</span>, <span class="number">2.0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment">* Removes all associations for a given object.</span></span><br><span class="line"><span class="comment">* </span></span><br><span class="line"><span class="comment">* @param object An object that maintains associated objects.</span></span><br><span class="line"><span class="comment">* </span></span><br><span class="line"><span class="comment">* @note The main purpose of this function is to make it easy to return an object </span></span><br><span class="line"><span class="comment">*  to a "pristine stateâ€. You should not use this function for general removal of</span></span><br><span class="line"><span class="comment">*  associations from objects, since it also removes associations that other clients</span></span><br><span class="line"><span class="comment">*  may have added to the object. Typically you should use \c objc_setAssociatedObject </span></span><br><span class="line"><span class="comment">*  with a nil value to clear an association.</span></span><br><span class="line"><span class="comment">* </span></span><br><span class="line"><span class="comment">* @see objc_setAssociatedObject</span></span><br><span class="line"><span class="comment">* @see objc_getAssociatedObject</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">OBJC_EXPORT <span class="keyword">void</span></span><br><span class="line">objc_removeAssociatedObjects(<span class="keyword">id</span> _Nonnull object)</span><br><span class="line">OBJC_AVAILABLE(<span class="number">10.6</span>, <span class="number">3.1</span>, <span class="number">9.0</span>, <span class="number">1.0</span>, <span class="number">2.0</span>);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>å®˜æ–¹çš„è§£é‡Šå·²ç»å¾ˆæ¸…æ™°äº†ï¼Œå°±ä¸è¿‡å¤šè§£è¯»äº†(ç»‘å®šã€è·å–ã€ç§»é™¤)ï¼Œå€¼å¾—æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼š<code>objc_removeAssociatedObjects</code>æ˜¯ç§»é™¤ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰å…³è”å¯¹è±¡ï¼Œå°†è¯¥å¯¹è±¡æ¢å¤æˆâ€œåŸå§‹â€çŠ¶æ€ï¼Œè¿™æ ·çš„æ“ä½œé£é™©å¤ªå¤§ï¼Œæ‰€ä»¥ä¸€èˆ¬çš„åšæ³•æ˜¯é€šè¿‡ç»™ <code>objc_setAssociatedObject</code> å‡½æ•°ä¼ å…¥ nil æ¥ç§»é™¤æŸä¸ªå·²æœ‰çš„å…³è”å¯¹è±¡ã€‚å¦‚ä¸‹è¿™æ ·ğŸ‘‡ğŸ‘‡ğŸ‘‡<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objc_setAssociatedObject(<span class="keyword">self</span>, &amp;key, <span class="literal">nil</span>, OBJC_ASSOCIATION_RETAIN_NONATOMIC);</span><br></pre></td></tr></table></figure></p>
<ul>
<li><p>å…³äºkeyçš„é—®é¢˜</p>
<blockquote>
<ul>
<li>å£°æ˜ static char kAssociatedObjectKey; ä½¿ç”¨ &amp;kAssociatedObjectKey ä½œä¸º key å€¼;</li>
<li>å£°æ˜ static void *kAssociatedObjectKey = &kAssociatedObjectKey; ä½¿ç”¨ kAssociatedObjectKey ä½œä¸º key å€¼ï¼›</li>
<li>ç”¨ selector ï¼Œä½¿ç”¨ getter æ–¹æ³•çš„åç§°ä½œä¸º key å€¼ã€‚</li>
</ul>
</blockquote>
</li>
<li><p>å…³äºpolicy(å…³è”ç­–ç•¥)çš„é—®é¢˜</p>
</li>
</ul>
<blockquote>
<p>OBJC_ASSOCIATION_ASSIGN<br>ç­‰ä»·å±æ€§@property (assign) or @property (unsafe_unretained)<br>å¼±å¼•ç”¨å…³è”å¯¹è±¡</p>
</blockquote>
<blockquote>
<p>OBJC_ASSOCIATION_RETAIN_NONATOMIC<br>ç­‰ä»·å±æ€§@property (strong, nonatomic)<br>å¼ºå¼•ç”¨å…³è”å¯¹è±¡ï¼Œä¸”ä¸ºéåŸå­æ“ä½œ</p>
</blockquote>
<blockquote>
<p>OBJC_ASSOCIATION_COPY_NONATOMIC<br>ç­‰ä»·å±æ€§@property (copy, nonatomic)<br>å¤åˆ¶å…³è”å¯¹è±¡ï¼Œä¸”ä¸ºéåŸå­æ“ä½œ</p>
</blockquote>
<blockquote>
<p>OBJC_ASSOCIATION_RETAIN<br>ç­‰ä»·å±æ€§@property (strong, atomic)<br>å¼ºå¼•ç”¨å…³è”å¯¹è±¡ï¼Œä¸”ä¸ºåŸå­æ“ä½œ</p>
</blockquote>
<blockquote>
<p>OBJC_ASSOCIATION_COPY<br>ç­‰ä»·å±æ€§@property (copy, atomic)<br>å¤åˆ¶å…³è”å¯¹è±¡ï¼Œä¸”ä¸ºåŸå­æ“ä½œ</p>
</blockquote>
<p>å…·ä½“å†…å®¹å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼Œè¿™é‡Œå°±ä¸copyäº†</p>
<h3 id="ä¸‰ã€ç”¨å…³è”å¯¹è±¡è§£å†³ä¸Šè¿°é—®é¢˜"><a href="#ä¸‰ã€ç”¨å…³è”å¯¹è±¡è§£å†³ä¸Šè¿°é—®é¢˜" class="headerlink" title="ä¸‰ã€ç”¨å…³è”å¯¹è±¡è§£å†³ä¸Šè¿°é—®é¢˜"></a>ä¸‰ã€ç”¨å…³è”å¯¹è±¡è§£å†³ä¸Šè¿°é—®é¢˜</h3><ul>
<li><p>ä¼ æ•´å‹æ•°æ®</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span> *<span class="keyword">const</span> kButtonKey = <span class="string">@"kButtonKey"</span>;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setupFoundationUI &#123;</span><br><span class="line"><span class="built_in">UIButton</span> *btn = [<span class="built_in">UIButton</span> buttonWithType:<span class="built_in">UIButtonTypeSystem</span>];</span><br><span class="line">objc_setAssociatedObject(btn, &amp;kButtonKey, @<span class="number">110</span>, OBJC_ASSOCIATION_ASSIGN);</span><br><span class="line">[<span class="keyword">self</span>.view addSubview:btn];</span><br><span class="line">[btn addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(btnDidClick:) forControlEvents:<span class="built_in">UIControlEventTouchUpInside</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)btnDidClick:(<span class="built_in">UIButton</span> *)sender &#123;</span><br><span class="line"><span class="built_in">NSInteger</span> value = [objc_getAssociatedObject(sender, &amp;kButtonKey) integerValue];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"btn did click ...value = %zd"</span>, value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä¼ å¯¹è±¡æ•°æ®</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span> *<span class="keyword">const</span> kButtonKey = <span class="string">@"kButtonKey"</span>;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setupFoundationUI &#123;</span><br><span class="line"><span class="built_in">UIButton</span> *btn = [<span class="built_in">UIButton</span> buttonWithType:<span class="built_in">UIButtonTypeSystem</span>];</span><br><span class="line">btn.frame = (<span class="built_in">CGRect</span>)&#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">30</span>, <span class="number">30</span>&#125;;</span><br><span class="line">Person *person = [[Person alloc] init];</span><br><span class="line">person.name = <span class="string">@"LiMing"</span>;</span><br><span class="line">objc_setAssociatedObject(btn, &amp;kButtonKey, person, OBJC_ASSOCIATION_RETAIN_NONATOMIC);</span><br><span class="line">[<span class="keyword">self</span>.view addSubview:btn];</span><br><span class="line">[btn addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(btnDidClick:) forControlEvents:<span class="built_in">UIControlEventTouchUpInside</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)btnDidClick:(<span class="built_in">UIButton</span> *)sender &#123;</span><br><span class="line">Person *person = objc_getAssociatedObject(sender, &amp;kButtonKey);</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"person`s name = %@"</span>, person.name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="å››ã€å…³è”å¯¹è±¡ç”¨äºCategory"><a href="#å››ã€å…³è”å¯¹è±¡ç”¨äºCategory" class="headerlink" title="å››ã€å…³è”å¯¹è±¡ç”¨äºCategory"></a>å››ã€å…³è”å¯¹è±¡ç”¨äºCategory</h3><p>ä»¥å®ç°UIBarButtonItemçš„æ‰©å±•ä¸ºä¾‹å­ï¼Œä¸ºå…¶å¢åŠ çº¢ç‚¹çš„åŠŸèƒ½ï¼Œå…¶ä¸­å¤§é‡çš„ä½¿ç”¨äº†å…³è”å¯¹è±¡<br>éœ€æ±‚ï¼š</p>
<blockquote>
<p>1.æ˜¾ç¤ºå°çº¢ç‚¹<br>2.æ˜¾ç¤ºæ•°å­—çº¢ç‚¹<br>3.å³æœ‰å°çº¢ç‚¹åˆæœ‰æ•°å­—çº¢ç‚¹æ—¶ï¼Œä¼˜å…ˆæ˜¾ç¤ºæ•°å­—çº¢ç‚¹<br>4.å¯è‡ªå®šä¹‰çº¢ç‚¹é¢œè‰²ï¼ˆé»˜è®¤æ˜¯çº¢è‰²[UIColor redColor]ï¼‰<br>5.æ•°å­—çº¢ç‚¹æ•°ç›®å¤§äº99æ—¶ï¼Œæ˜¾ç¤º99+</p>
</blockquote>
<p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼šğŸ‘‡ğŸ‘‡ğŸ‘‡<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">UIBarButtonItem</span> (<span class="title">Badge</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>, <span class="keyword">nonatomic</span>) <span class="built_in">UIColor</span> *badgeColor;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)configBadgeWithBigNum:(<span class="built_in">NSInteger</span>)bigNum small:(<span class="built_in">BOOL</span>)isOn;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"UIBarButtonItem+Badge.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;objc/runtime.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">NSString</span> *<span class="keyword">const</span> ZYBarButtonItem_hasBadgeKey = <span class="string">@"ZYBarButtonItem_hasBadgeKey"</span>;</span><br><span class="line"><span class="built_in">NSString</span> *<span class="keyword">const</span> ZYBarButtonItem_badgeKey = <span class="string">@"ZYBarButtonItem_badgeKey"</span>;</span><br><span class="line"><span class="built_in">NSString</span> *<span class="keyword">const</span> ZYBarButtonItem_badgeSizeKey = <span class="string">@"ZYBarButtonItem_badgeSizeKey"</span>;</span><br><span class="line"><span class="built_in">NSString</span> *<span class="keyword">const</span> ZYBarButtonItem_badgeOriginXKey = <span class="string">@"ZYBarButtonItem_badgeOriginXKey"</span>;</span><br><span class="line"><span class="built_in">NSString</span> *<span class="keyword">const</span> ZYBarButtonItem_badgeOriginYKey = <span class="string">@"ZYBarButtonItem_badgeOriginYKey"</span>;</span><br><span class="line"><span class="built_in">NSString</span> *<span class="keyword">const</span> ZYBarButtonItem_badgeColorKey = <span class="string">@"ZYBarButtonItem_badgeColorKey"</span>;</span><br><span class="line"><span class="built_in">NSString</span> *<span class="keyword">const</span> ZYBarButtonItem_badgeSizeWKey = <span class="string">@"ZYBarButtonItem_badgeSizeWKey"</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">UIBarButtonItem</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">CGFloat</span> badgeSizeW;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">UILabel</span> *badge;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>, <span class="keyword">nonatomic</span>) <span class="built_in">CGFloat</span> badgeOriginX;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>, <span class="keyword">nonatomic</span>) <span class="built_in">CGFloat</span> badgeOriginY;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>, <span class="keyword">nonatomic</span>) <span class="built_in">CGFloat</span> badgeSize;</span><br><span class="line"><span class="keyword">@property</span> <span class="built_in">BOOL</span> hasBadge;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">UIBarButtonItem</span> (<span class="title">Badge</span>)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)initBadge &#123;</span><br><span class="line"><span class="built_in">UIView</span> *superview = <span class="literal">nil</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">self</span>.customView) &#123;</span><br><span class="line">superview = <span class="keyword">self</span>.customView;</span><br><span class="line">superview.clipsToBounds = <span class="literal">NO</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> ([<span class="keyword">self</span> respondsToSelector:<span class="keyword">@selector</span>(view)] &amp;&amp; [(<span class="keyword">id</span>)<span class="keyword">self</span> view]) &#123;</span><br><span class="line">superview = [(<span class="keyword">id</span>)<span class="keyword">self</span> view];</span><br><span class="line">&#125;</span><br><span class="line">[superview addSubview:<span class="keyword">self</span>.badge];</span><br><span class="line"></span><br><span class="line"><span class="comment">// é»˜è®¤è®¾ç½® default configure</span></span><br><span class="line"><span class="keyword">self</span>.badgeColor = [<span class="built_in">UIColor</span> redColor];</span><br><span class="line"><span class="keyword">self</span>.badgeSize = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">self</span>.badgeSizeW = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">self</span>.badgeOriginX = <span class="number">28</span>;</span><br><span class="line"><span class="keyword">self</span>.badgeOriginY = <span class="number">8</span>;</span><br><span class="line"><span class="keyword">self</span>.badge.hidden = <span class="literal">YES</span>;</span><br><span class="line"><span class="keyword">self</span>.badge.layer.masksToBounds = <span class="literal">YES</span>;</span><br><span class="line"><span class="keyword">self</span>.badge.font = [<span class="built_in">UIFont</span> boldSystemFontOfSize:<span class="number">12</span>];</span><br><span class="line"><span class="keyword">self</span>.badge.textAlignment = <span class="built_in">NSTextAlignmentCenter</span>;</span><br><span class="line"><span class="keyword">self</span>.badge.textColor = [<span class="built_in">UIColor</span> whiteColor];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)showBadge &#123;</span><br><span class="line"><span class="keyword">self</span>.badge.hidden = <span class="literal">NO</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)hideBadge &#123;</span><br><span class="line"><span class="keyword">self</span>.badge.hidden = <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)refreshBadge &#123;</span><br><span class="line"><span class="keyword">self</span>.badge.frame = (<span class="built_in">CGRect</span>)&#123;<span class="keyword">self</span>.badgeOriginX,<span class="keyword">self</span>.badgeOriginY,<span class="keyword">self</span>.badgeSizeW,<span class="keyword">self</span>.badgeSize&#125;;</span><br><span class="line"><span class="keyword">self</span>.badge.backgroundColor = <span class="keyword">self</span>.badgeColor;</span><br><span class="line"><span class="keyword">self</span>.badge.layer.cornerRadius = <span class="keyword">self</span>.badgeSize/<span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark ---------- badge getter &amp; setter function -----------</span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">UILabel</span> *)badge &#123;</span><br><span class="line"><span class="built_in">UILabel</span> *badge = (<span class="built_in">UILabel</span> *)objc_getAssociatedObject(<span class="keyword">self</span>, &amp;ZYBarButtonItem_badgeKey);</span><br><span class="line"><span class="keyword">if</span> (!badge) &#123;</span><br><span class="line">badge = [[<span class="built_in">UILabel</span> alloc] init];</span><br><span class="line">[<span class="keyword">self</span> setBadge:badge];</span><br><span class="line">[<span class="keyword">self</span> initBadge];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> badge;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setBadge:(<span class="built_in">UILabel</span> *)badge &#123;</span><br><span class="line">objc_setAssociatedObject(<span class="keyword">self</span>, &amp;ZYBarButtonItem_badgeKey, badge, OBJC_ASSOCIATION_RETAIN_NONATOMIC);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">UIColor</span> *)badgeColor &#123;</span><br><span class="line"><span class="keyword">return</span> objc_getAssociatedObject(<span class="keyword">self</span>, &amp;ZYBarButtonItem_badgeColorKey);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setBadgeColor:(<span class="built_in">UIColor</span> *)badgeColor &#123;</span><br><span class="line">objc_setAssociatedObject(<span class="keyword">self</span>, &amp;ZYBarButtonItem_badgeColorKey, badgeColor, OBJC_ASSOCIATION_RETAIN_NONATOMIC);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">self</span>.badge) &#123;</span><br><span class="line">[<span class="keyword">self</span> refreshBadge];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="built_in">CGFloat</span>)badgeSize &#123;</span><br><span class="line"><span class="built_in">NSNumber</span> *number = objc_getAssociatedObject(<span class="keyword">self</span>, &amp;ZYBarButtonItem_badgeSizeKey);</span><br><span class="line"><span class="keyword">return</span> number.floatValue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)setBadgeSize:(<span class="built_in">CGFloat</span>)badgeSize &#123;</span><br><span class="line"><span class="built_in">NSNumber</span> *number = [<span class="built_in">NSNumber</span> numberWithDouble:badgeSize];</span><br><span class="line">objc_setAssociatedObject(<span class="keyword">self</span>, &amp;ZYBarButtonItem_badgeSizeKey, number, OBJC_ASSOCIATION_RETAIN_NONATOMIC);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">self</span>.badge) &#123;</span><br><span class="line">[<span class="keyword">self</span> refreshBadge];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">CGFloat</span>)badgeSizeW &#123;</span><br><span class="line"><span class="built_in">NSNumber</span> *number = objc_getAssociatedObject(<span class="keyword">self</span>, &amp;ZYBarButtonItem_badgeSizeWKey);</span><br><span class="line"><span class="keyword">return</span> number.floatValue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setBadgeSizeW:(<span class="built_in">CGFloat</span>)badgeSizeW &#123;</span><br><span class="line"><span class="built_in">NSNumber</span> *number = [<span class="built_in">NSNumber</span> numberWithDouble:badgeSizeW];</span><br><span class="line">objc_setAssociatedObject(<span class="keyword">self</span>, &amp;ZYBarButtonItem_badgeSizeWKey, number, OBJC_ASSOCIATION_RETAIN_NONATOMIC);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">self</span>.badge) &#123;</span><br><span class="line">[<span class="keyword">self</span> refreshBadge];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="built_in">CGFloat</span>)badgeOriginX &#123;</span><br><span class="line"><span class="built_in">NSNumber</span> *number = objc_getAssociatedObject(<span class="keyword">self</span>, &amp;ZYBarButtonItem_badgeOriginXKey);</span><br><span class="line"><span class="keyword">return</span> number.floatValue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)setBadgeOriginX:(<span class="built_in">CGFloat</span>)badgeOriginX &#123;</span><br><span class="line"><span class="built_in">NSNumber</span> *number = [<span class="built_in">NSNumber</span> numberWithDouble:badgeOriginX];</span><br><span class="line">objc_setAssociatedObject(<span class="keyword">self</span>, &amp;ZYBarButtonItem_badgeOriginXKey, number, OBJC_ASSOCIATION_RETAIN_NONATOMIC);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">self</span>.badge) &#123;</span><br><span class="line">[<span class="keyword">self</span> refreshBadge];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="built_in">CGFloat</span>)badgeOriginY &#123;</span><br><span class="line"><span class="built_in">NSNumber</span> *number = objc_getAssociatedObject(<span class="keyword">self</span>, &amp;ZYBarButtonItem_badgeOriginYKey);</span><br><span class="line"><span class="keyword">return</span> number.floatValue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)setBadgeOriginY:(<span class="built_in">CGFloat</span>)badgeOriginY &#123;</span><br><span class="line"><span class="built_in">NSNumber</span> *number = [<span class="built_in">NSNumber</span> numberWithDouble:badgeOriginY];</span><br><span class="line">objc_setAssociatedObject(<span class="keyword">self</span>, &amp;ZYBarButtonItem_badgeOriginYKey, number, OBJC_ASSOCIATION_RETAIN_NONATOMIC);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">self</span>.badge) &#123;</span><br><span class="line">[<span class="keyword">self</span> refreshBadge];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setHasBadge:(<span class="built_in">BOOL</span>)hasBadge &#123;</span><br><span class="line"><span class="keyword">if</span> (hasBadge) &#123;</span><br><span class="line">[<span class="keyword">self</span> showBadge];</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">[<span class="keyword">self</span> hideBadge];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSNumber</span> *number = [<span class="built_in">NSNumber</span> numberWithBool:hasBadge];</span><br><span class="line">objc_setAssociatedObject(<span class="keyword">self</span>, &amp;ZYBarButtonItem_hasBadgeKey, number, OBJC_ASSOCIATION_RETAIN_NONATOMIC);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">BOOL</span>)hasBadge &#123;</span><br><span class="line"><span class="built_in">NSNumber</span> *number = objc_getAssociatedObject(<span class="keyword">self</span>, &amp;ZYBarButtonItem_hasBadgeKey);</span><br><span class="line"><span class="keyword">return</span> number.boolValue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - Public</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)configBadgeWithBigNum:(<span class="built_in">NSInteger</span>)bigNum small:(<span class="built_in">BOOL</span>)isOn &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (bigNum &gt; <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">self</span>.hasBadge = <span class="literal">YES</span>;</span><br><span class="line"><span class="keyword">self</span>.badgeSize = <span class="number">18</span>;</span><br><span class="line"><span class="keyword">self</span>.badgeOriginY = <span class="number">6</span>;</span><br><span class="line"><span class="built_in">NSString</span> *numStr = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%zd"</span>, bigNum];</span><br><span class="line"><span class="keyword">if</span> (bigNum &lt; <span class="number">10</span>) &#123;</span><br><span class="line"><span class="keyword">self</span>.badgeSizeW = <span class="number">18</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (bigNum &lt; <span class="number">100</span>) &#123;</span><br><span class="line"><span class="keyword">self</span>.badgeSizeW = <span class="number">25</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">self</span>.badgeSizeW = <span class="number">30</span>;</span><br><span class="line">numStr = <span class="string">@"99+"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">self</span>.badge.text = numStr;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (isOn) &#123;</span><br><span class="line"><span class="keyword">self</span>.hasBadge = <span class="literal">YES</span>;</span><br><span class="line"><span class="keyword">self</span>.badgeSizeW = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">self</span>.badgeSize = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">self</span>.badgeOriginY = <span class="number">8</span>;</span><br><span class="line"><span class="keyword">self</span>.badge.text = <span class="literal">nil</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">self</span>.hasBadge = <span class="literal">NO</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<h3 id="äº”ã€å†™åœ¨æœ€å"><a href="#äº”ã€å†™åœ¨æœ€å" class="headerlink" title="äº”ã€å†™åœ¨æœ€å"></a>äº”ã€å†™åœ¨æœ€å</h3><ul>
<li>å…³è”å¯¹è±¡ä¸è¢«å…³è”å¯¹è±¡æœ¬èº«çš„å­˜å‚¨å¹¶æ²¡æœ‰ç›´æ¥çš„å…³ç³»ï¼Œå®ƒæ˜¯å­˜å‚¨åœ¨å•ç‹¬çš„å“ˆå¸Œè¡¨ä¸­çš„ï¼›</li>
<li>å…³è”å¯¹è±¡çš„äº”ç§å…³è”ç­–ç•¥ä¸å±æ€§çš„é™å®šç¬¦éå¸¸ç±»ä¼¼ï¼Œåœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½ä¼šä½¿ç”¨ <code>OBJC_ASSOCIATION_RETAIN_NONATOMIC</code> çš„å…³è”ç­–ç•¥ï¼Œè¿™å¯ä»¥ä¿è¯æˆ‘ä»¬æŒæœ‰å…³è”å¯¹è±¡ï¼›</li>
<li>å…³è”å¯¹è±¡çš„é‡Šæ”¾æ—¶æœºä¸ç§»é™¤æ—¶æœºå¹¶ä¸æ€»æ˜¯ä¸€è‡´ï¼Œæ¯”å¦‚ç”¨å…³è”ç­–ç•¥ <code>OBJC_ASSOCIATION_ASSIGN</code> è¿›è¡Œå…³è”çš„å¯¹è±¡ï¼Œå¾ˆæ—©å°±å·²ç»è¢«é‡Šæ”¾äº†ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰è¢«ç§»é™¤ï¼Œè€Œå†ä½¿ç”¨è¿™ä¸ªå…³è”å¯¹è±¡æ—¶å°±ä¼šé€ æˆ Crash ã€‚<br><img src="http://upload-images.jianshu.io/upload_images/6544436-db0fc9959f867882.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Associated.jpg"></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/01/iOS-å…³äºBlockï¼Œä½ ä¸å¾—ä¸çŸ¥/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Leewin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Welcome">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/01/iOS-å…³äºBlockï¼Œä½ ä¸å¾—ä¸çŸ¥/" itemprop="url">iOS-å…³äºBlockï¼Œä½ ä¸å¾—ä¸çŸ¥</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-01T18:30:31+08:00">
                2018-01-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h3><p>ä»£ç å—Blockæ˜¯è‹¹æœåœ¨iOS4å¼€å§‹å¼•å…¥çš„å¯¹Cè¯­è¨€çš„æ‰©å±•ï¼Œç”¨æ¥å®ç°åŒ¿åå‡½æ•°çš„ç‰¹æ€§ï¼ŒBlockæ˜¯ä¸€ç§ç‰¹æ®Šçš„æ•°æ®ç±»å‹ï¼Œå…¶å¯ä»¥æ­£å¸¸å®šä¹‰å˜é‡ã€ä½œä¸ºå‚æ•°ã€ä½œä¸ºè¿”å›å€¼ï¼Œç‰¹æ®Šçš„Blockè¿˜å¯ä»¥ä¿å­˜ä¸€æ®µä»£ç ï¼Œåœ¨éœ€è¦çš„æ—¶å€™è°ƒç”¨ï¼Œç›®å‰Blockå·²ç»å¹¿æ³›åº”ç”¨äºiOSå¼€å‘ä¸­ï¼Œå¸¸ç”¨äºGCDã€åŠ¨ç”»ã€æ’åºåŠå„ç±»å›è°ƒç­‰ã€‚ï¼ˆä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œå…¨æ–‡ä»¥ä¸¾ä¾‹ä»£ç ä¸ºä¸»ï¼‰</p>
<h3 id="äºŒã€Blockå¸¸è§„ä½¿ç”¨"><a href="#äºŒã€Blockå¸¸è§„ä½¿ç”¨" class="headerlink" title="äºŒã€Blockå¸¸è§„ä½¿ç”¨"></a>äºŒã€Blockå¸¸è§„ä½¿ç”¨</h3><h4 id="1-Blockå±æ€§"><a href="#1-Blockå±æ€§" class="headerlink" title="1.Blockå±æ€§"></a>1.Blockå±æ€§</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ¼å¼</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) return_type (^blockName) (var_type);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¾‹å¦‚ ç”¨äºå‘é€æœ¬ç±»ä¸­çš„å¼‚å¸¸æ—¶</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="keyword">void</span>(^postErrorMessageHandler)(<span class="built_in">NSString</span> *errorMsg, <span class="built_in">CGFloat</span> offsetY);</span><br></pre></td></tr></table></figure>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®ç°å¦‚ä¸‹</span></span><br><span class="line">- (<span class="keyword">void</span>)postErrorMsgWith:(<span class="built_in">NSString</span> *)errorMsg offsetY:(<span class="built_in">CGFloat</span>)offSetY &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">self</span>.postErrorMessageHandler) &#123;</span><br><span class="line"><span class="keyword">self</span>.postErrorMessageHandler(errorMsg, offSetY);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è°ƒç”¨</span></span><br><span class="line">__<span class="keyword">weak</span> <span class="keyword">typeof</span>(<span class="keyword">self</span>)weakSelf = <span class="keyword">self</span>;</span><br><span class="line">obj.postErrorMessageHandler = ^(<span class="built_in">NSString</span> *errorMsg, <span class="built_in">CGFloat</span> offsetY) &#123;</span><br><span class="line">__<span class="keyword">strong</span> <span class="keyword">typeof</span>(weakSelf)strongSelf = weakSelf;</span><br><span class="line">[strongSelf showToastWith:errorMsg offsetY:offsetY];</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="2-Blockä½œä¸ºå½¢å‚"><a href="#2-Blockä½œä¸ºå½¢å‚" class="headerlink" title="2.Blockä½œä¸ºå½¢å‚"></a>2.Blockä½œä¸ºå½¢å‚</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ¼å¼</span></span><br><span class="line">- (<span class="keyword">void</span>)yourMethod:(return_type (^)(var_type))blockName;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¾‹å¦‚ ç”¨äºè·å–ç”¨æˆ·ä¿¡æ¯æ—¶</span></span><br><span class="line">- (<span class="keyword">void</span>)fetchUserInfoWithCompletion:(<span class="keyword">void</span> (^)(User *userInfo, GetInfoError *error))completion;</span><br></pre></td></tr></table></figure>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®ç°å¦‚ä¸‹</span></span><br><span class="line">- (<span class="keyword">void</span>)fetchUserInfoWithCompletion:(<span class="keyword">void</span> (^)(User *userInfo, GetInfoError *error))completion &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">self</span>.isHaveCompletionInfo == <span class="literal">NO</span>) &#123;</span><br><span class="line">completion(<span class="literal">nil</span>, [GetInfoError errorWithMessage:<span class="string">@"è¯·å®Œå–„ç”¨æˆ·ä¿¡æ¯"</span> success:<span class="literal">NO</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">completion(<span class="keyword">self</span>.userInfo, <span class="literal">nil</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// è°ƒç”¨</span><br><span class="line">__weak typeof(self)weakSelf = self;</span><br><span class="line">[obj fetchUserInfoWithCompletion:^(User *userInfo, GetInfoError *error) &#123;</span><br><span class="line">__strong typeof(weakSelf)strongSelf = weakSelf;</span><br><span class="line">if (error) &#123;</span><br><span class="line">[strongSelf postErrorMsgWith:error.message];</span><br><span class="line">&#125; else &#123;</span><br><span class="line">SaveInfo(userInfo);</span><br><span class="line">&#125;</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<h4 id="3-ä½¿ç”¨typedefå®šä¹‰Blockç±»å‹"><a href="#3-ä½¿ç”¨typedefå®šä¹‰Blockç±»å‹" class="headerlink" title="3.ä½¿ç”¨typedefå®šä¹‰Blockç±»å‹"></a>3.ä½¿ç”¨typedefå®šä¹‰Blockç±»å‹</h4><p>è§‚å¯Ÿä¸Šé¢çš„ä½¿ç”¨æƒ…å†µä¸éš¾çœ‹å‡ºï¼Œåœ¨å®é™…ä½¿ç”¨Blockçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦é‡å¤åœ°å£°æ˜å¤šä¸ªç›¸åŒè¿”å›å€¼ç›¸åŒå‚æ•°åˆ—è¡¨çš„Blockå˜é‡ï¼Œå¦‚æœæ€»æ˜¯é‡å¤åœ°ç¼–å†™ä¸€é•¿ä¸²ä»£ç æ¥å£°æ˜å˜é‡ä¼šéå¸¸ç¹çï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨typedefæ¥å®šä¹‰Blockç±»</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ¼å¼</span></span><br><span class="line"><span class="keyword">typedef</span> return_type(^BlockName)(var_type);</span><br></pre></td></tr></table></figure>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¾‹å¦‚(ç”±ä¸Šä¾‹å˜å½¢)</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">void</span>(^MessageHandler)(<span class="built_in">NSString</span> *errorMsg, <span class="built_in">CGFloat</span> offsetY);</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) MessageHandler postErrorMessageHandler;</span><br></pre></td></tr></table></figure>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å†ä¾‹å¦‚(ç”±ä¸Šä¾‹å˜å½¢)</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">void</span>(^Completion)(User *userInfo, GetInfoError *error);</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)fetchUserInfoWithCompletion:(Completion)completion;</span><br></pre></td></tr></table></figure>
<h3 id="ä¸‰ã€åœ¨Blockå†…éƒ¨è®¿é—®å±€éƒ¨å˜é‡"><a href="#ä¸‰ã€åœ¨Blockå†…éƒ¨è®¿é—®å±€éƒ¨å˜é‡" class="headerlink" title="ä¸‰ã€åœ¨Blockå†…éƒ¨è®¿é—®å±€éƒ¨å˜é‡"></a>ä¸‰ã€åœ¨Blockå†…éƒ¨è®¿é—®å±€éƒ¨å˜é‡</h3><h4 id="1-åœ¨Blockä¸­å¯ä»¥è®¿é—®å±€éƒ¨å˜é‡"><a href="#1-åœ¨Blockä¸­å¯ä»¥è®¿é—®å±€éƒ¨å˜é‡" class="headerlink" title="1.åœ¨Blockä¸­å¯ä»¥è®¿é—®å±€éƒ¨å˜é‡"></a>1.åœ¨Blockä¸­å¯ä»¥è®¿é—®å±€éƒ¨å˜é‡</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å£°æ˜å±€éƒ¨å˜é‡age</span></span><br><span class="line"><span class="keyword">int</span> age = <span class="number">18</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span>(^logAgeBlock)() = ^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"current age = %d"</span>, age);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒç”¨åæ§åˆ¶å°è¾“å‡º"current age = 18"</span></span><br><span class="line">logAgeBlock();</span><br></pre></td></tr></table></figure>
<h4 id="2-Blockå†…å±€éƒ¨å˜é‡çš„å€¼åœ¨å£°æ˜Blockç¡®å®šï¼Œä¸ä¼šéšåé¢ä¿®æ”¹è€Œæ”¹å˜ï¼Œåœ¨è°ƒç”¨Blockæ—¶å±€éƒ¨å˜é‡å€¼æ˜¯å£°æ˜Blockæ—¶çš„æ—§å€¼"><a href="#2-Blockå†…å±€éƒ¨å˜é‡çš„å€¼åœ¨å£°æ˜Blockç¡®å®šï¼Œä¸ä¼šéšåé¢ä¿®æ”¹è€Œæ”¹å˜ï¼Œåœ¨è°ƒç”¨Blockæ—¶å±€éƒ¨å˜é‡å€¼æ˜¯å£°æ˜Blockæ—¶çš„æ—§å€¼" class="headerlink" title="2.Blockå†…å±€éƒ¨å˜é‡çš„å€¼åœ¨å£°æ˜Blockç¡®å®šï¼Œä¸ä¼šéšåé¢ä¿®æ”¹è€Œæ”¹å˜ï¼Œåœ¨è°ƒç”¨Blockæ—¶å±€éƒ¨å˜é‡å€¼æ˜¯å£°æ˜Blockæ—¶çš„æ—§å€¼"></a>2.Blockå†…å±€éƒ¨å˜é‡çš„å€¼åœ¨å£°æ˜Blockç¡®å®šï¼Œä¸ä¼šéšåé¢ä¿®æ”¹è€Œæ”¹å˜ï¼Œåœ¨è°ƒç”¨Blockæ—¶å±€éƒ¨å˜é‡å€¼æ˜¯å£°æ˜Blockæ—¶çš„æ—§å€¼</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> age = <span class="number">18</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span>(^logAgeBlock)() = ^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"current age = %d"</span>, age);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">age = <span class="number">24</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒç”¨åæ§åˆ¶å°è¾“å‡º"current age = 18"</span></span><br><span class="line">logAgeBlock();</span><br></pre></td></tr></table></figure>
<h4 id="3-åœ¨Blockä¸­ä¸å¯ä»¥ç›´æ¥ä¿®æ”¹å±€éƒ¨å˜é‡"><a href="#3-åœ¨Blockä¸­ä¸å¯ä»¥ç›´æ¥ä¿®æ”¹å±€éƒ¨å˜é‡" class="headerlink" title="3.åœ¨Blockä¸­ä¸å¯ä»¥ç›´æ¥ä¿®æ”¹å±€éƒ¨å˜é‡"></a>3.åœ¨Blockä¸­ä¸å¯ä»¥ç›´æ¥ä¿®æ”¹å±€éƒ¨å˜é‡</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> age = <span class="number">18</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span>(^logAgeBlock)() = ^&#123;</span><br><span class="line">age ++; <span class="comment">//è¿™å¥æŠ¥é”™: Variable is not assignable(missing __block type specifier)</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"current age = %d"</span>, age);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="4-è¯¥å¦‚ä½•ä¿®æ”¹å±€éƒ¨å˜é‡ï¼Ÿ"><a href="#4-è¯¥å¦‚ä½•ä¿®æ”¹å±€éƒ¨å˜é‡ï¼Ÿ" class="headerlink" title="4.è¯¥å¦‚ä½•ä¿®æ”¹å±€éƒ¨å˜é‡ï¼Ÿ"></a>4.è¯¥å¦‚ä½•ä¿®æ”¹å±€éƒ¨å˜é‡ï¼Ÿ</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å£°æ˜å±€éƒ¨å˜é‡global</span></span><br><span class="line">__block <span class="keyword">int</span> age = <span class="number">18</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span>(^logAgeBlock)() = ^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"current age = %d"</span>, age);</span><br><span class="line">&#125;;</span><br><span class="line">age = <span class="number">24</span>;</span><br><span class="line"><span class="comment">// è°ƒç”¨åæ§åˆ¶å°è¾“å‡º"current age = 24"</span></span><br><span class="line">logAgeBlock();</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">__block <span class="keyword">int</span> age = <span class="number">18</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span>(^logAgeBlock)() = ^&#123;</span><br><span class="line">age ++; <span class="comment">// è¿™å¥æ­£ç¡®</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"current age = %d"</span>, age);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// è°ƒç”¨åæ§åˆ¶å°è¾“å‡º"current age = 19"</span></span><br><span class="line">logAgeBlock();</span><br></pre></td></tr></table></figure></p>
<h3 id="å››ã€Blockå¼•å‘çš„å†…å­˜æ³„éœ²"><a href="#å››ã€Blockå¼•å‘çš„å†…å­˜æ³„éœ²" class="headerlink" title="å››ã€Blockå¼•å‘çš„å†…å­˜æ³„éœ²"></a>å››ã€Blockå¼•å‘çš„å†…å­˜æ³„éœ²</h3><h4 id="1-åœ¨Blockçš„å†…å­˜å­˜å‚¨åœ¨å †ä¸­æ—¶-å¦‚æœåœ¨Blockä¸­å¼•ç”¨äº†å¤–é¢çš„å¯¹è±¡-ä¼šå¯¹æ‰€å¼•ç”¨çš„å¯¹è±¡è¿›è¡Œå¼ºå¼•ç”¨-ä½†æ˜¯åœ¨Blockè¢«é‡Šæ”¾æ—¶ä¼šè‡ªåŠ¨å»æ‰å¯¹è¯¥å¯¹è±¡çš„å¼ºå¼•ç”¨-æ‰€ä»¥ä¸ä¼šé€ æˆå†…å­˜æ³„æ¼"><a href="#1-åœ¨Blockçš„å†…å­˜å­˜å‚¨åœ¨å †ä¸­æ—¶-å¦‚æœåœ¨Blockä¸­å¼•ç”¨äº†å¤–é¢çš„å¯¹è±¡-ä¼šå¯¹æ‰€å¼•ç”¨çš„å¯¹è±¡è¿›è¡Œå¼ºå¼•ç”¨-ä½†æ˜¯åœ¨Blockè¢«é‡Šæ”¾æ—¶ä¼šè‡ªåŠ¨å»æ‰å¯¹è¯¥å¯¹è±¡çš„å¼ºå¼•ç”¨-æ‰€ä»¥ä¸ä¼šé€ æˆå†…å­˜æ³„æ¼" class="headerlink" title="1.åœ¨Blockçš„å†…å­˜å­˜å‚¨åœ¨å †ä¸­æ—¶,å¦‚æœåœ¨Blockä¸­å¼•ç”¨äº†å¤–é¢çš„å¯¹è±¡,ä¼šå¯¹æ‰€å¼•ç”¨çš„å¯¹è±¡è¿›è¡Œå¼ºå¼•ç”¨,ä½†æ˜¯åœ¨Blockè¢«é‡Šæ”¾æ—¶ä¼šè‡ªåŠ¨å»æ‰å¯¹è¯¥å¯¹è±¡çš„å¼ºå¼•ç”¨,æ‰€ä»¥ä¸ä¼šé€ æˆå†…å­˜æ³„æ¼"></a>1.åœ¨Blockçš„å†…å­˜å­˜å‚¨åœ¨å †ä¸­æ—¶,å¦‚æœåœ¨Blockä¸­å¼•ç”¨äº†å¤–é¢çš„å¯¹è±¡,ä¼šå¯¹æ‰€å¼•ç”¨çš„å¯¹è±¡è¿›è¡Œå¼ºå¼•ç”¨,ä½†æ˜¯åœ¨Blockè¢«é‡Šæ”¾æ—¶ä¼šè‡ªåŠ¨å»æ‰å¯¹è¯¥å¯¹è±¡çš„å¼ºå¼•ç”¨,æ‰€ä»¥ä¸ä¼šé€ æˆå†…å­˜æ³„æ¼</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">User *user = [[User alloc] init];</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span>(^invokingBlock)() = ^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"log user : %@"</span>, user);</span><br><span class="line">&#125;;</span><br><span class="line">invokingBlock();</span><br><span class="line"></span><br><span class="line"><span class="comment">// userå¯¹è±¡åœ¨è¿™é‡Œå¯ä»¥æ­£å¸¸è¢«é‡Šæ”¾</span></span><br></pre></td></tr></table></figure>
<h4 id="2-å¦‚æœå¯¹è±¡å†…éƒ¨æœ‰ä¸€ä¸ªBlockå±æ€§-è€Œåœ¨Blockå†…éƒ¨åˆè®¿é—®äº†è¯¥å¯¹è±¡-é‚£ä¹ˆä¼šé€ æˆå¾ªç¯å¼•ç”¨"><a href="#2-å¦‚æœå¯¹è±¡å†…éƒ¨æœ‰ä¸€ä¸ªBlockå±æ€§-è€Œåœ¨Blockå†…éƒ¨åˆè®¿é—®äº†è¯¥å¯¹è±¡-é‚£ä¹ˆä¼šé€ æˆå¾ªç¯å¼•ç”¨" class="headerlink" title="2.å¦‚æœå¯¹è±¡å†…éƒ¨æœ‰ä¸€ä¸ªBlockå±æ€§,è€Œåœ¨Blockå†…éƒ¨åˆè®¿é—®äº†è¯¥å¯¹è±¡,é‚£ä¹ˆä¼šé€ æˆå¾ªç¯å¼•ç”¨"></a>2.å¦‚æœå¯¹è±¡å†…éƒ¨æœ‰ä¸€ä¸ªBlockå±æ€§,è€Œåœ¨Blockå†…éƒ¨åˆè®¿é—®äº†è¯¥å¯¹è±¡,é‚£ä¹ˆä¼šé€ æˆå¾ªç¯å¼•ç”¨</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">User</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="keyword">void</span>(^invokingBlock)();</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">User</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)dealloc &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%s dealloc"</span>, __func__);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line">User *user = [[User alloc] init];</span><br><span class="line"></span><br><span class="line">user.invokingBlock = ^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"log user : %@"</span>, user);</span><br><span class="line">&#125;;</span><br><span class="line">user.invokingBlock();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å› ä¸ºinvokingBlockä½œä¸ºUserçš„å±æ€§ï¼Œé‡‡ç”¨copyä¿®é¥°ç¬¦ä¿®é¥°(è¿™æ ·æ‰èƒ½ä¿è¯Blockåœ¨å †é‡Œé¢ï¼Œä»¥å…Blockåœ¨æ ˆä¸­è¢«ç³»ç»Ÿé‡Šæ”¾)ï¼Œæ‰€ä»¥Blockä¼šå¯¹Userå¯¹è±¡è¿›è¡Œä¸€æ¬¡å¼ºå¼•ç”¨,å¯¼è‡´å¾ªç¯å¼•ç”¨æ— æ³•é‡Šæ”¾</span></span><br></pre></td></tr></table></figure>
<p>å¦ä¸€ç§æƒ…å†µğŸ‘‡ğŸ‘‡ğŸ‘‡</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">User</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="keyword">void</span>(^invokingBlock)();</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)resetBlock;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">User</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)resetBlock &#123;</span><br><span class="line"><span class="keyword">self</span>.invokingBlock = ^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"log user : %@"</span>, <span class="keyword">self</span>);</span><br><span class="line">&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)dealloc &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%s dealloc"</span>, __func__);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line">User *user = [[User alloc] init];</span><br><span class="line">[user resetBlock];</span><br><span class="line"></span><br><span class="line"><span class="comment">// Userå¯¹è±¡åœ¨è¿™é‡Œæ— æ³•æ­£å¸¸é‡Šæ”¾,åœ¨resetBlockæ–¹æ³•å®ç°ä¸­,Blockå†…éƒ¨å¯¹selfè¿›è¡Œäº†ä¸€æ¬¡å¼ºå¼•ç”¨,å¯¼è‡´å¾ªç¯å¼•ç”¨æ— æ³•é‡Šæ”¾</span></span><br></pre></td></tr></table></figure>
<h4 id="3-å¦‚æœå¯¹è±¡å†…éƒ¨æœ‰ä¸€ä¸ªBlockå±æ€§ï¼Œè€Œåœ¨Blockå†…éƒ¨åˆè®¿é—®äº†è¯¥å¯¹è±¡-é‚£ä¹ˆä¼šé€ æˆå¾ªç¯å¼•ç”¨ï¼Œè§£å†³å¾ªç¯å¼•ç”¨çš„åŠæ³•æ˜¯ä½¿ç”¨ä¸€ä¸ªå¼±å¼•ç”¨çš„æŒ‡é’ˆæŒ‡å‘è¯¥å¯¹è±¡ï¼Œç„¶ååœ¨Blockå†…éƒ¨ä½¿ç”¨è¯¥å¼±å¼•ç”¨æŒ‡é’ˆæ¥è¿›è¡Œæ“ä½œï¼Œè¿™æ ·é¿å…äº†Blockå¯¹å¯¹è±¡è¿›è¡Œå¼ºå¼•ç”¨"><a href="#3-å¦‚æœå¯¹è±¡å†…éƒ¨æœ‰ä¸€ä¸ªBlockå±æ€§ï¼Œè€Œåœ¨Blockå†…éƒ¨åˆè®¿é—®äº†è¯¥å¯¹è±¡-é‚£ä¹ˆä¼šé€ æˆå¾ªç¯å¼•ç”¨ï¼Œè§£å†³å¾ªç¯å¼•ç”¨çš„åŠæ³•æ˜¯ä½¿ç”¨ä¸€ä¸ªå¼±å¼•ç”¨çš„æŒ‡é’ˆæŒ‡å‘è¯¥å¯¹è±¡ï¼Œç„¶ååœ¨Blockå†…éƒ¨ä½¿ç”¨è¯¥å¼±å¼•ç”¨æŒ‡é’ˆæ¥è¿›è¡Œæ“ä½œï¼Œè¿™æ ·é¿å…äº†Blockå¯¹å¯¹è±¡è¿›è¡Œå¼ºå¼•ç”¨" class="headerlink" title="3.å¦‚æœå¯¹è±¡å†…éƒ¨æœ‰ä¸€ä¸ªBlockå±æ€§ï¼Œè€Œåœ¨Blockå†…éƒ¨åˆè®¿é—®äº†è¯¥å¯¹è±¡,é‚£ä¹ˆä¼šé€ æˆå¾ªç¯å¼•ç”¨ï¼Œè§£å†³å¾ªç¯å¼•ç”¨çš„åŠæ³•æ˜¯ä½¿ç”¨ä¸€ä¸ªå¼±å¼•ç”¨çš„æŒ‡é’ˆæŒ‡å‘è¯¥å¯¹è±¡ï¼Œç„¶ååœ¨Blockå†…éƒ¨ä½¿ç”¨è¯¥å¼±å¼•ç”¨æŒ‡é’ˆæ¥è¿›è¡Œæ“ä½œï¼Œè¿™æ ·é¿å…äº†Blockå¯¹å¯¹è±¡è¿›è¡Œå¼ºå¼•ç”¨"></a>3.å¦‚æœå¯¹è±¡å†…éƒ¨æœ‰ä¸€ä¸ªBlockå±æ€§ï¼Œè€Œåœ¨Blockå†…éƒ¨åˆè®¿é—®äº†è¯¥å¯¹è±¡,é‚£ä¹ˆä¼šé€ æˆå¾ªç¯å¼•ç”¨ï¼Œè§£å†³å¾ªç¯å¼•ç”¨çš„åŠæ³•æ˜¯ä½¿ç”¨ä¸€ä¸ªå¼±å¼•ç”¨çš„æŒ‡é’ˆæŒ‡å‘è¯¥å¯¹è±¡ï¼Œç„¶ååœ¨Blockå†…éƒ¨ä½¿ç”¨è¯¥å¼±å¼•ç”¨æŒ‡é’ˆæ¥è¿›è¡Œæ“ä½œï¼Œè¿™æ ·é¿å…äº†Blockå¯¹å¯¹è±¡è¿›è¡Œå¼ºå¼•ç”¨</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">User</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="keyword">void</span>(^invokingBlock)();</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">User</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)dealloc &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%s dealloc"</span>, __func__);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line">User *user = [[User alloc] init];</span><br><span class="line">__<span class="keyword">weak</span> <span class="keyword">typeof</span>(user) weakUser = user;</span><br><span class="line"></span><br><span class="line">user.invokingBlock = ^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"log user : %@"</span>, weakUser);</span><br><span class="line">&#125;;</span><br><span class="line">user.invokingBlock();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Userå¯¹è±¡åœ¨è¿™é‡Œå¯ä»¥æ­£å¸¸è¢«é‡Šæ”¾</span></span><br></pre></td></tr></table></figure>
<p>å¦ä¸€ç§æƒ…å†µğŸ‘‡ğŸ‘‡ğŸ‘‡</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">User</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="keyword">void</span>(^invokingBlock)();</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)resetBlock;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">User</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)resetBlock &#123;</span><br><span class="line"><span class="comment">// è¿™é‡Œä¸ºäº†é€šç”¨ä¸€ç‚¹,å¯ä»¥ä½¿ç”¨__weak typeof(self) weakUser = self;</span></span><br><span class="line">__<span class="keyword">weak</span> User *weakUser = <span class="keyword">self</span>;</span><br><span class="line"><span class="keyword">self</span>.invokingBlock = ^&#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"log user : %@"</span>, weakUser);</span><br><span class="line">&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)dealloc &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%s dealloc"</span>, __func__);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">User *user = [[User alloc] init];</span><br><span class="line">[user resetBlock];</span><br><span class="line"></span><br><span class="line"><span class="comment">// Userå¯¹è±¡åœ¨è¿™é‡Œå¯ä»¥æ­£å¸¸è¢«é‡Šæ”¾</span></span><br></pre></td></tr></table></figure>
<h3 id="äº”ã€å†™åœ¨æœ€å"><a href="#äº”ã€å†™åœ¨æœ€å" class="headerlink" title="äº”ã€å†™åœ¨æœ€å"></a>äº”ã€å†™åœ¨æœ€å</h3><ul>
<li>æœ¬æ–‡æ—¨åœ¨æµ…æBlockçš„å¸¸è§„ä½¿ç”¨åŠæ³¨æ„äº‹é¡¹ï¼ˆä¸»è¦æ˜¯å¾ªç¯å¼•ç”¨å¯¼è‡´çš„å†…å­˜æ³„éœ²ï¼‰ï¼Œå†…å®¹ä¸æ·±ï¼Œè¿˜æ˜¯ä»¥ä¸¾ä¾‹ç”¨æ³•ä¸ºä¸»ï¼›</li>
<li>æœ¬äººç»å†äº† -&gt;ä¸å¤ªä¼šç”¨ -&gt; ç»å¸¸ä¼šæœ‰ -&gt; å†…å­˜æ³„éœ² -&gt; æ­£ç¡®ä½¿ç”¨ï¼Œç”±è¡·çš„å–œæ¬¢Blockï¼›</li>
<li>Blockæ˜¯OCé‡Œå¾ˆä¼˜ç§€çš„ä¸œè¥¿ï¼Œæ•è·å˜é‡ã€ä»£ç ä¼ é€’ã€ä»£ç å†…è”ç­‰ç‰¹æ€§èµ‹äºˆäº†å®ƒå¤šäºä»£ç†æœºåˆ¶çš„åŠŸèƒ½å’Œçµæ´»æ€§ï¼›</li>
<li>å¸Œæœ›è¯»è€…æœ‰æ‰€æ”¶è·ï¼<br><img src="http://upload-images.jianshu.io/upload_images/6544436-6253c618343c1c70.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ç£æ¹–.png"></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/12/04/iOS-åœ°å›¾å¼€å‘-é‚£äº›å¹´æˆ‘ä»¬é‡åˆ°çš„å‘/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Leewin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Welcome">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/04/iOS-åœ°å›¾å¼€å‘-é‚£äº›å¹´æˆ‘ä»¬é‡åˆ°çš„å‘/" itemprop="url">iOS åœ°å›¾å¼€å‘-é‚£äº›å¹´æˆ‘ä»¬é‡åˆ°çš„å‘~</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-12-04T21:24:02+08:00">
                2017-12-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h3><p>åœ°å›¾å¼€å‘çš„é‡è¦æ€§å°±ä¸è®²äº†ï¼Œå¤§å®¶çœ‹ä¸€ä¸‹è‡ªå·±æ‰‹æœºé‡Œçš„Appå°±çŸ¥é“äº†ï¼Œ10ä¸ªAppæœ‰9ä¸ªåŒ…å«äº†ä½ç½®æœåŠ¡åŠŸèƒ½ï¼Œè€Œä¸”å‘å±•åˆ°ä»Šå¤©ï¼Œç²¾å‡†åº¦å·²ç»éå¸¸é«˜äº†ã€‚balabalaâ€¦â€¦</p>
<p><img src="http://upload-images.jianshu.io/upload_images/6544436-876f33e7750431d3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/240" alt="æˆ‘æ˜¯åœ°å›¾.png"></p>
<h3 id="äºŒã€å…³äºåœ°å›¾çš„Info-plistæ–‡ä»¶é…ç½®"><a href="#äºŒã€å…³äºåœ°å›¾çš„Info-plistæ–‡ä»¶é…ç½®" class="headerlink" title="äºŒã€å…³äºåœ°å›¾çš„Info.plistæ–‡ä»¶é…ç½®"></a>äºŒã€å…³äºåœ°å›¾çš„Info.plistæ–‡ä»¶é…ç½®</h3><p>iOS 10 å’ŒiOS 11 çš„è®¾ç½®åˆ†åˆ«æ˜¯è¿™æ ·é…ç½®çš„ï¼ˆå¦‚ä¸‹å›¾ï¼‰<br>æ³¨ï¼šæ¯æ¬¡Appleæœ‰å¤§ç‰ˆæœ¬æ›´æ–°ï¼Œéƒ½å¾—æ£€æŸ¥ä¸€ä¸‹plistæ–‡ä»¶çš„æƒé™é…ç½®</p>
<p><img src="http://upload-images.jianshu.io/upload_images/6544436-a961b4cdbc63ed99.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="iOS 10 ä½ç½®æœåŠ¡æƒé™é…ç½®.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6544436-990f785450c1f812.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="iOS 11 ä½ç½®æœåŠ¡æƒé™é…ç½®.png"></p>
<p>å¦‚æœé…ç½®ä¸å®Œæ•´ï¼Œåœ¨éƒ¨åˆ†ç³»ç»Ÿä¸Šæ˜¯æ— æ³•åŠ è½½åœ°å›¾çš„ï¼ˆæ˜¾ç¤ºä¸ºä¸€ç‰‡è“è‰²ï¼‰ï¼Œä¸”åœ¨ç›¸åº”Appçš„è®¾ç½®é‡Œéƒ½æ‰¾ä¸åˆ°ã€ä½ç½®ã€è¿™ä¸€é¡¹ã€‚åä¹‹ï¼Œå¦‚æœä½ å‘ç°è®¾ç½®é‡Œæ²¡æœ‰ã€ä½ç½®ã€ï¼Œå¤§æ¦‚å°±æ˜¯æƒé™é…ç½®æœ‰é—®é¢˜äº†ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/6544436-6a224bbc9a9c0541.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/240" alt="ã€ä½ç½®ã€.png"></p>
<h3 id="ä¸‰ã€æˆ‘ä»¬ç”¨é‚£ç§åœ°å›¾æ›´å¥½ï¼Ÿ"><a href="#ä¸‰ã€æˆ‘ä»¬ç”¨é‚£ç§åœ°å›¾æ›´å¥½ï¼Ÿ" class="headerlink" title="ä¸‰ã€æˆ‘ä»¬ç”¨é‚£ç§åœ°å›¾æ›´å¥½ï¼Ÿ"></a>ä¸‰ã€æˆ‘ä»¬ç”¨é‚£ç§åœ°å›¾æ›´å¥½ï¼Ÿ</h3><p>å¸¸ç”¨çš„åœ°å›¾ï¼šé«˜å¾·åœ°å›¾ã€ç™¾åº¦åœ°å›¾ã€è…¾è®¯åœ°å›¾ã€Googleåœ°å›¾ã€Appleåœ°å›¾</p>
<h4 id="1-åŸºäºåŠŸèƒ½çš„å¼ºå¤§ï¼Œä¸ªäººé¦–æ¨é«˜å¾·åœ°å›¾ï¼ˆå¦‚æœä¸éœ€è¦å›½é™…åŒ–ï¼‰"><a href="#1-åŸºäºåŠŸèƒ½çš„å¼ºå¤§ï¼Œä¸ªäººé¦–æ¨é«˜å¾·åœ°å›¾ï¼ˆå¦‚æœä¸éœ€è¦å›½é™…åŒ–ï¼‰" class="headerlink" title="1.åŸºäºåŠŸèƒ½çš„å¼ºå¤§ï¼Œä¸ªäººé¦–æ¨é«˜å¾·åœ°å›¾ï¼ˆå¦‚æœä¸éœ€è¦å›½é™…åŒ–ï¼‰"></a>1.åŸºäºåŠŸèƒ½çš„å¼ºå¤§ï¼Œä¸ªäººé¦–æ¨é«˜å¾·åœ°å›¾ï¼ˆå¦‚æœä¸éœ€è¦å›½é™…åŒ–ï¼‰</h4><p>æˆ‘è®¤ä¸ºé«˜å¾·åœ°å›¾æ˜¯æˆ‘å¤§å¤©æœæœ€å¥½çš„åœ°å›¾ä¾›åº”å•†ï¼ˆä»…é™äºå›½å†…ï¼‰ï¼Œä¸»è¦åŸå› å½“ç„¶æ˜¯é‡Œé¢çš„ä»£ç†æ–¹æ³•ç›¸å½“çš„ä¸°å¯Œï¼Œæ–‡æ¡£ä¹Ÿå¾ˆæ¸…æ™°ã€‚</p>
<h4 id="2-å¦‚æœéœ€è¦å›½é™…åŒ–ï¼Œå°±åªèƒ½è€ƒè™‘Appleåœ°å›¾å’ŒGoogleåœ°å›¾äº†"><a href="#2-å¦‚æœéœ€è¦å›½é™…åŒ–ï¼Œå°±åªèƒ½è€ƒè™‘Appleåœ°å›¾å’ŒGoogleåœ°å›¾äº†" class="headerlink" title="2.å¦‚æœéœ€è¦å›½é™…åŒ–ï¼Œå°±åªèƒ½è€ƒè™‘Appleåœ°å›¾å’ŒGoogleåœ°å›¾äº†"></a>2.å¦‚æœéœ€è¦å›½é™…åŒ–ï¼Œå°±åªèƒ½è€ƒè™‘Appleåœ°å›¾å’ŒGoogleåœ°å›¾äº†</h4><p>Googleåœ°å›¾å½“ç„¶å¾ˆå¥½ï¼ˆå¯èƒ½æ˜¯åœ°çƒä¸Šæœ€å¥½çš„åœ°å›¾æœåŠ¡å•†ï¼‰ï¼Œä½†å…è´¹ç‰ˆåªæä¾›äº†åŸºç¡€çš„å®šä½æœåŠ¡ï¼Œå…´è¶£ç‚¹ç­‰ç¨é«˜çº§çš„æœåŠ¡éƒ½æ˜¯æ”¶è´¹çš„ï¼Œæ‰€ä»¥ï¼ŒåŸºäºã€å‹¤ä¿­èŠ‚çº¦ã€ï¼Œå°±æ”¾å¼ƒå§ï¼</p>
<h4 id="3-é‡ç‚¹æ¥äº†ï¼ŒAppleåœ°å›¾"><a href="#3-é‡ç‚¹æ¥äº†ï¼ŒAppleåœ°å›¾" class="headerlink" title="3.é‡ç‚¹æ¥äº†ï¼ŒAppleåœ°å›¾"></a>3.é‡ç‚¹æ¥äº†ï¼ŒAppleåœ°å›¾</h4><p>å…¶å®ï¼ŒAppleåœ°å›¾çš„æ•°æ®å¹¶ä¸æ˜¯Appleå…¬å¸æä¾›çš„ã€‚å¤§å®¶æ‰“å¼€è‡ªå¸¦çš„åœ°å›¾Appï¼Œçœ‹çœ‹å·¦ä¸‹è§’ï¼Œæœ‰ä¸€ä¸ªã€é«˜å¾·åœ°å›¾ã€çš„æ ‡å¿—ï¼Œé‚£åœ°å¤„æ­ªæœçš„iPhoneé‡Œåœ°å›¾Appæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿç­”æ¡ˆæ˜¯ã€TomTomã€ï¼Œå¤§å®¶ç•ªç¾½å¢™å‡ºå»ï¼Œå†æ‰“å¼€çœ‹çœ‹å°±çŸ¥é“äº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒAppleåªæ‹¿ç€åˆ«äººå®¶çš„æ•°æ®ï¼Œä¼˜åŒ–äº†ä¸€ä¸‹UIï¼Œå°±æˆäº†Appleåœ°å›¾äº†ï¼Œå®ƒè‡ªå·±æ˜¯æ²¡æœ‰åœ°å›¾æ•°æ®çš„ï¼Œå°±æ›´ä¸èƒ½æä¾›åœ°å›¾æœåŠ¡äº†ã€‚Appleåœ°å›¾æ˜¯æ ¹æ®å½“å‰ç½‘ç»œæ‰€å¤„çš„å›½å®¶ï¼Œè‡ªåŠ¨è¯·æ±‚ä¸åŒæœåŠ¡å•†çš„æ•°æ®ï¼ˆå›½å†…æ˜¯é«˜å¾·ï¼Œå›½å¤–åˆ™æ˜¯Tom Tomï¼‰ã€‚Appleåœ°å›¾çš„APIå®Œå…¨æ²¡æœ‰é«˜å¾·åœ°å›¾çš„APIä¸°å¯Œã€‚</p>
<p>æ³¨ï¼šå…¶å®å¦‚æœä¸šåŠ¡é€»è¾‘ä¸é‚£ä¹ˆå¤æ‚ï¼Œç›´æ¥ç”¨Appleåœ°å›¾å°±è¡Œäº†ã€‚æ¯•ç«ŸåŸç”Ÿï¼Œç®€å•ã€å¥½ç”¨ã€‚ï¼ˆæ–‡æ¡£ä¸­éƒ½æœ‰ï¼‰</p>
<h3 id="å››ã€åŸç”Ÿåœ°å›¾çš„å‘"><a href="#å››ã€åŸç”Ÿåœ°å›¾çš„å‘" class="headerlink" title="å››ã€åŸç”Ÿåœ°å›¾çš„å‘"></a>å››ã€åŸç”Ÿåœ°å›¾çš„å‘</h3><p>ã€é™„è¿‘çš„å…´è¶£ç‚¹ã€ï¼ï¼ï¼ï¼ˆå…´è¶£ç‚¹ å­¦åï¼šPOI - Point of Interestï¼‰</p>
<p>ã€å…³é”®å­—æ£€ç´¢POIã€å°±å¤§å®¶éƒ½æœ‰ï¼Œå°±ä¸è¯´äº†ã€‚è¿™é‡Œä¸»è¦è¯´ä¸€ä¸‹ã€æ£€ç´¢å‘¨è¾¹POIã€ã€‚</p>
<h4 id="1-ä»€ä¹ˆå«ã€é™„è¿‘çš„å…´è¶£ç‚¹ã€ï¼Ÿ"><a href="#1-ä»€ä¹ˆå«ã€é™„è¿‘çš„å…´è¶£ç‚¹ã€ï¼Ÿ" class="headerlink" title="1.ä»€ä¹ˆå«ã€é™„è¿‘çš„å…´è¶£ç‚¹ã€ï¼Ÿ"></a>1.ä»€ä¹ˆå«ã€é™„è¿‘çš„å…´è¶£ç‚¹ã€ï¼Ÿ</h4><p>åœ¨åœ°å›¾è¡¨è¾¾ä¸­ï¼Œä¸€ä¸ªPOIå¯ä»£è¡¨ä¸€æ ‹å¤§å¦ã€ä¸€å®¶å•†é“ºã€ä¸€å¤„æ™¯ç‚¹ç­‰ç­‰ã€‚é€šè¿‡POIæœç´¢ï¼Œå®Œæˆæ‰¾é¤é¦†ã€æ‰¾æ™¯ç‚¹ã€æ‰¾å•æ‰€ç­‰ç­‰çš„åŠŸèƒ½ã€‚<br>æ¯”å¦‚ï¼šé™„è¿‘çš„åœè½¦åœºã€é™„è¿‘çš„å»ºç­‘ã€é™„è¿‘çš„å…¬å¸ã€é™„è¿‘çš„ç”µå½±é™¢ã€‚</p>
<h4 id="2-é«˜å¾·åœ°å›¾å¦‚ä½•å®ç°ï¼Ÿ"><a href="#2-é«˜å¾·åœ°å›¾å¦‚ä½•å®ç°ï¼Ÿ" class="headerlink" title="2.é«˜å¾·åœ°å›¾å¦‚ä½•å®ç°ï¼Ÿ"></a>2.é«˜å¾·åœ°å›¾å¦‚ä½•å®ç°ï¼Ÿ</h4><p>é«˜å¾·åœ°å›¾çš„POIç±»åˆ«å…±20ä¸ªå¤§ç±»ï¼Œåˆ†åˆ«ä¸ºï¼šï¼ˆInterestKeyï¼‰</p>
<ul>
<li>æ±½è½¦æœåŠ¡ã€æ±½è½¦é”€å”®ã€æ±½è½¦ç»´ä¿®ã€æ‘©æ‰˜è½¦æœåŠ¡ã€é¤é¥®æœåŠ¡ã€</li>
<li>è´­ç‰©æœåŠ¡ã€ç”Ÿæ´»æœåŠ¡ã€ä½“è‚²ä¼‘é—²æœåŠ¡ã€åŒ»ç–—ä¿å¥æœåŠ¡ã€ä½å®¿æœåŠ¡ã€</li>
<li>é£æ™¯åèƒœã€å•†åŠ¡ä½å®…ã€æ”¿åºœæœºæ„åŠç¤¾ä¼šå›¢ä½“ã€ç§‘æ•™æ–‡åŒ–æœåŠ¡ã€äº¤é€šè®¾æ–½æœåŠ¡ã€</li>
<li>é‡‘èä¿é™©æœåŠ¡ã€å…¬å¸ä¼ä¸šã€é“è·¯é™„å±è®¾æ–½ã€åœ°ååœ°å€ä¿¡æ¯ã€å…¬å…±è®¾æ–½</li>
</ul>
<p>æ³¨ï¼šä¸è®¾ç½®POIçš„ç±»åˆ«ï¼Œé»˜è®¤è¿”å›â€œé¤é¥®æœåŠ¡â€ã€â€œå•†åŠ¡ä½å®…â€ã€â€œç”Ÿæ´»æœåŠ¡â€è¿™ä¸‰ç§ç±»åˆ«çš„POI</p>
<ul>
<li>é«˜å¾·åœ°å›¾çš„é™„è¿‘POIæ£€ç´¢ï¼ˆAMapPOIAroundSearchRequestï¼‰</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)loadAroundPOIsInAMapWithCoordinate:(<span class="built_in">CLLocationCoordinate2D</span>)coordinate &#123;</span><br><span class="line"></span><br><span class="line">AMapPOIAroundSearchRequest *request = [[AMapPOIAroundSearchRequest alloc]init];</span><br><span class="line">request.location = [AMapGeoPoint locationWithLatitude:coordinate.latitude longitude:coordinate.longitude];</span><br><span class="line"><span class="comment">// exp : @"å…¬å¸ä¼ä¸š|æ”¿åºœæœºæ„åŠç¤¾ä¼šå›¢ä½“|é“è·¯é™„å±è®¾æ–½|åœ°ååœ°å€ä¿¡æ¯"</span></span><br><span class="line">request.types = InterestKey;</span><br><span class="line">request.sortrule = <span class="number">0</span>;</span><br><span class="line">request.requireExtension = <span class="literal">YES</span>;</span><br><span class="line"></span><br><span class="line">[<span class="keyword">self</span>.search AMapPOIAroundSearch:request];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)onPOISearchDone:(AMapPOISearchBaseRequest *)request response:(AMapPOISearchResponse *)response &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (AMapPOI *poi <span class="keyword">in</span> response.pois) &#123;</span><br><span class="line"><span class="comment">// æ£€ç´¢çš„ç»“æœ</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>é«˜å¾·åœ°å›¾çš„å…³é”®å­—æ£€ç´¢æ˜¯å¦ä¸€å¥—æ–¹æ³•ï¼ˆAMapInputTipsSearchRequestï¼‰<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)searchInAMapWith:(<span class="built_in">NSString</span> *)searchKey &#123;</span><br><span class="line"></span><br><span class="line">AMapInputTipsSearchRequest *request = [[AMapInputTipsSearchRequest alloc]init];</span><br><span class="line">request.keywords = searchKey;</span><br><span class="line">request.types = <span class="string">@"å…¬å¸ä¼ä¸š|æ”¿åºœæœºæ„åŠç¤¾ä¼šå›¢ä½“"</span>;</span><br><span class="line">[<span class="keyword">self</span>.search AMapInputTipsSearch:request];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)onInputTipsSearchDone:(AMapInputTipsSearchRequest *)request response:(AMapInputTipsSearchResponse *)response &#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSMutableArray</span> *resultArrM = [<span class="built_in">NSMutableArray</span> array];</span><br><span class="line"><span class="keyword">for</span> (AMapTip *tip <span class="keyword">in</span> response.tips) &#123;</span><br><span class="line"><span class="comment">// æ£€ç´¢çš„ç»“æœ</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="3-Appleåœ°å›¾å¦‚ä½•å®ç°ï¼Ÿ"><a href="#3-Appleåœ°å›¾å¦‚ä½•å®ç°ï¼Ÿ" class="headerlink" title="3.Appleåœ°å›¾å¦‚ä½•å®ç°ï¼Ÿ"></a>3.Appleåœ°å›¾å¦‚ä½•å®ç°ï¼Ÿ</h4><p>ã€è‡£å¦¾ã€åšä¸åˆ°ï¼ï¼ï¼æˆ‘ä¹Ÿå¾ˆæ— å¥ˆï¼ï¼ï¼</p>
<ul>
<li>å¥½å§ï¼Œå…¶å®ä¹Ÿæœ‰ä¸€ä¸ªæ¯”è¾ƒå‡‘åˆçš„æ–¹å¼ï¼ˆéå¸¸å‡‘åˆï¼‰ï¼š</li>
</ul>
<p>é‚£å°±æ˜¯æœ‰å…³é”®å­—æ£€ç´¢çš„æ–¹å¼ï¼Œå›ºå®šæ£€ç´¢äº‹å…ˆè®¾ç½®å¥½çš„å…³é”®å­—ï¼Œæ¯”å¦‚ï¼š<br>Company|Community|cafe|supermarket|village|<br>Shop|Restaurant|School|hospital|Street|<br>Convenience store|Shopping Centre|Place names|Hotel|Grocery store<br>ç»è¿‡å®æµ‹ï¼Œæœ‰ä¸€å®šçš„æ•ˆæœï¼ˆæ¯•ç«Ÿï¼Œæœ‰æ€»æ¯”æ²¡æœ‰å¥½~ï¼‰<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">- (void)loadAroundPOIsInAppleMapWithCoordinate:(CLLocationCoordinate2D)coordinate &#123;</span><br><span class="line"></span><br><span class="line">MKCoordinateSpan span = &#123;0.005, 0.005&#125;;</span><br><span class="line">MKCoordinateRegion region = &#123;coordinate, span&#125;; //MKCoordinateRegionMakeWithDistance(coordinate,1000, 1000);</span><br><span class="line">MKLocalSearchRequest *req = [[MKLocalSearchRequest alloc] init];</span><br><span class="line">req.region = region;</span><br><span class="line">req.naturalLanguageQuery = @&quot;Company&quot;;</span><br><span class="line">MKLocalSearch * ser = [[MKLocalSearch alloc] initWithRequest:req];</span><br><span class="line">//å¼€å§‹æ£€ç´¢ï¼Œç»“æœè¿”å›åœ¨blockä¸­</span><br><span class="line">[ser startWithCompletionHandler:^(MKLocalSearchResponse *response, NSError *error) &#123;</span><br><span class="line">if (error) &#123;</span><br><span class="line">return ;</span><br><span class="line">&#125;</span><br><span class="line">//å…´è¶£ç‚¹èŠ‚ç‚¹æ•°ç»„</span><br><span class="line">for (MKMapItem *item in response.mapItems) &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>å¦‚æœæ˜¯çœŸæ­£çš„å…³é”®å­—æ£€ç´¢å‘¢ï¼Ÿå¤§å®¶è‡ªè¡Œå¯¹æ¯”ä¸€ä¸‹ï¼ˆå…¶å®æ˜¯ä¸€æ¨¡ä¸€æ ·ï¼Œå”¯ä¸€ä¸åŒå°±æ˜¯naturalLanguageQueryçš„ä¸åŒä½¿ç”¨ï¼Œæ³¨ï¼šéå®˜æ–¹åšæ³•ï¼Œæ…é‡ï¼ï¼‰<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)searchInAppleMapWithNaturaLanguage:(<span class="built_in">NSString</span> *)searchKey &#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">MKCoordinateRegion</span> region = <span class="keyword">self</span>.mkMapView.region;</span><br><span class="line"><span class="built_in">MKLocalSearchRequest</span> *req = [[<span class="built_in">MKLocalSearchRequest</span> alloc] init];</span><br><span class="line">req.region = region;</span><br><span class="line">req.naturalLanguageQuery = searchKey;</span><br><span class="line"><span class="built_in">MKLocalSearch</span> * ser = [[<span class="built_in">MKLocalSearch</span> alloc] initWithRequest:req];</span><br><span class="line"><span class="comment">//å¼€å§‹æ£€ç´¢ï¼Œç»“æœè¿”å›åœ¨blockä¸­</span></span><br><span class="line">[ser startWithCompletionHandler:^(<span class="built_in">MKLocalSearchResponse</span> *response, <span class="built_in">NSError</span> *error) &#123;</span><br><span class="line"><span class="keyword">if</span> (error) &#123;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å…´è¶£ç‚¹èŠ‚ç‚¹æ•°ç»„</span></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">MKMapItem</span> *item <span class="keyword">in</span> response.mapItems) &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="äº”ã€å…³äºåœ°å›¾åæ ‡ç³»çš„é—®é¢˜"><a href="#äº”ã€å…³äºåœ°å›¾åæ ‡ç³»çš„é—®é¢˜" class="headerlink" title="äº”ã€å…³äºåœ°å›¾åæ ‡ç³»çš„é—®é¢˜"></a>äº”ã€å…³äºåœ°å›¾åæ ‡ç³»çš„é—®é¢˜</h3><ul>
<li>åœ°çƒåæ ‡(WGS84) - æ˜¯å›½é™…æ ‡å‡†ï¼ŒGPSåæ ‡ï¼ˆGoogle Earthä½¿ç”¨ã€æˆ–è€…GPSæ¨¡å—ï¼‰- è‹¹æœçš„CLLocationManager</li>
<li>ç«æ˜Ÿåæ ‡(GCJ-02) - ä¸­å›½åæ ‡åç§»æ ‡å‡†ï¼ŒGoogleåœ°å›¾ã€é«˜å¾·ã€è…¾è®¯ä½¿ç”¨</li>
<li>ç™¾åº¦åæ ‡(BD-09) - ç™¾åº¦åæ ‡åç§»æ ‡å‡†ï¼ŒBaiduåœ°å›¾ä½¿ç”¨</li>
</ul>
<p>æˆ‘ä»¬ç»å¸¸åœ¨å¸¸ç”¨çš„è¿™å‡ ç§åœ°å›¾ä¸­è¿›è¡Œåæ ‡è½¬æ¢ï¼Œæˆ–ç”¨äºç¬¬ä¸‰æ–¹åœ°å›¾çš„å¯¼èˆªï¼Œæˆ–ç”¨äºåå°ä¸‹å‘åœ°å€çš„æ‰“ç‚¹ç­‰ç­‰åœºæ™¯ã€‚è™½ç„¶ç™¾åº¦å’Œé«˜å¾·éƒ½æä¾›ç›¸åº”çš„APIï¼Œä½†æ˜¯ä»–ä»¬éƒ½åªæä¾›å‘è‡ªå®¶åæ ‡ç³»è½¬åŒ–çš„APIï¼Œéœ€è¦è¿ç½‘è¯·æ±‚æ‰èƒ½å¾—åˆ°è½¬åŒ–åçš„ç»“æœã€‚</p>
<p>æä¾›ä¸€ä¸‹åæ ‡ç³»çš„è½¬æ¢ä»£ç  ğŸ‘‡ğŸ‘‡ğŸ‘‡</p>
<p>CLLocation+Sino.h<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;CoreLocation/CoreLocation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">CLLocation</span> (<span class="title">Sino</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**åœ°çƒåæ ‡è½¬ç«æ˜Ÿåæ ‡*/</span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">CLLocation</span>*)locationMarsFromEarth;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**ç«æ˜Ÿåæ ‡è½¬ç™¾åº¦åæ ‡*/</span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">CLLocation</span>*)locationBearPawFromMars;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**ç™¾åº¦åæ ‡è½¬ç«æ˜Ÿåæ ‡*/</span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">CLLocation</span>*)locationMarsFromBearPaw;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<p>CLLocation+Sino.m<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"CLLocation+Sino.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> transform_earth_2_mars(<span class="keyword">double</span> lat, <span class="keyword">double</span> lng, <span class="keyword">double</span>* tarLat, <span class="keyword">double</span>* tarLng);</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> transform_mars_2_bear_paw(<span class="keyword">double</span> lat, <span class="keyword">double</span> lng, <span class="keyword">double</span>* tarLat, <span class="keyword">double</span>* tarLng);</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> transform_bear_paw_2_mars(<span class="keyword">double</span> lat, <span class="keyword">double</span> lng, <span class="keyword">double</span>* tarLat, <span class="keyword">double</span>* tarLng);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">CLLocation</span> (<span class="title">Sino</span>)</span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">CLLocation</span>*) locationMarsFromEarth &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> lat = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> lng = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line">transform_earth_2_mars(<span class="keyword">self</span>.coordinate.latitude, <span class="keyword">self</span>.coordinate.longitude, &amp;lat, &amp;lng);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> [[<span class="built_in">CLLocation</span> alloc] initWithCoordinate:<span class="built_in">CLLocationCoordinate2DMake</span>(lat, lng)</span><br><span class="line"></span><br><span class="line">altitude:<span class="keyword">self</span>.altitude</span><br><span class="line"></span><br><span class="line">horizontalAccuracy:<span class="keyword">self</span>.horizontalAccuracy</span><br><span class="line"></span><br><span class="line">verticalAccuracy:<span class="keyword">self</span>.verticalAccuracy</span><br><span class="line"></span><br><span class="line">course:<span class="keyword">self</span>.course</span><br><span class="line"></span><br><span class="line">speed:<span class="keyword">self</span>.speed</span><br><span class="line"></span><br><span class="line">timestamp:<span class="keyword">self</span>.timestamp];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">CLLocation</span>*) locationBearPawFromMars &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> lat = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> lng = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line">transform_mars_2_bear_paw(<span class="keyword">self</span>.coordinate.latitude, <span class="keyword">self</span>.coordinate.longitude, &amp;lat, &amp;lng);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> [[<span class="built_in">CLLocation</span> alloc] initWithCoordinate:<span class="built_in">CLLocationCoordinate2DMake</span>(lat, lng)</span><br><span class="line"></span><br><span class="line">altitude:<span class="keyword">self</span>.altitude</span><br><span class="line"></span><br><span class="line">horizontalAccuracy:<span class="keyword">self</span>.horizontalAccuracy</span><br><span class="line"></span><br><span class="line">verticalAccuracy:<span class="keyword">self</span>.verticalAccuracy</span><br><span class="line"></span><br><span class="line">course:<span class="keyword">self</span>.course</span><br><span class="line"></span><br><span class="line">speed:<span class="keyword">self</span>.speed</span><br><span class="line"></span><br><span class="line">timestamp:<span class="keyword">self</span>.timestamp];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">CLLocation</span>*) locationMarsFromBearPaw &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> lat = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> lng = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line">transform_bear_paw_2_mars(<span class="keyword">self</span>.coordinate.latitude, <span class="keyword">self</span>.coordinate.longitude, &amp;lat, &amp;lng);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> [[<span class="built_in">CLLocation</span> alloc] initWithCoordinate:<span class="built_in">CLLocationCoordinate2DMake</span>(lat, lng)</span><br><span class="line"></span><br><span class="line">altitude:<span class="keyword">self</span>.altitude</span><br><span class="line"></span><br><span class="line">horizontalAccuracy:<span class="keyword">self</span>.horizontalAccuracy</span><br><span class="line"></span><br><span class="line">verticalAccuracy:<span class="keyword">self</span>.verticalAccuracy</span><br><span class="line"></span><br><span class="line">course:<span class="keyword">self</span>.course</span><br><span class="line"></span><br><span class="line">speed:<span class="keyword">self</span>.speed</span><br><span class="line"></span><br><span class="line">timestamp:<span class="keyword">self</span>.timestamp];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> a = <span class="number">6378245.0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> ee = <span class="number">0.00669342162296594323</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> transform_sino_out_china(<span class="keyword">double</span> lat, <span class="keyword">double</span> lon) &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (lon &lt; <span class="number">72.004</span> || lon &gt; <span class="number">137.8347</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (lat &lt; <span class="number">0.8293</span> || lat &gt; <span class="number">55.8271</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> transform_earth_2_mars_lat(<span class="keyword">double</span> x, <span class="keyword">double</span> y) &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> ret = <span class="number">-100.0</span> + <span class="number">2.0</span> * x + <span class="number">3.0</span> * y + <span class="number">0.2</span> * y * y + <span class="number">0.1</span> * x * y + <span class="number">0.2</span> * sqrt(fabs(x));</span><br><span class="line"></span><br><span class="line">ret += (<span class="number">20.0</span> * sin(<span class="number">6.0</span> * x * M_PI) + <span class="number">20.0</span> * sin(<span class="number">2.0</span> * x * M_PI)) * <span class="number">2.0</span> / <span class="number">3.0</span>;</span><br><span class="line"></span><br><span class="line">ret += (<span class="number">20.0</span> * sin(y * M_PI) + <span class="number">40.0</span> * sin(y / <span class="number">3.0</span> * M_PI)) * <span class="number">2.0</span> / <span class="number">3.0</span>;</span><br><span class="line"></span><br><span class="line">ret += (<span class="number">160.0</span> * sin(y / <span class="number">12.0</span> * M_PI) + <span class="number">320</span> * sin(y * M_PI / <span class="number">30.0</span>)) * <span class="number">2.0</span> / <span class="number">3.0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> transform_earth_2_mars_lng(<span class="keyword">double</span> x, <span class="keyword">double</span> y) &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> ret = <span class="number">300.0</span> + x + <span class="number">2.0</span> * y + <span class="number">0.1</span> * x * x + <span class="number">0.1</span> * x * y + <span class="number">0.1</span> * sqrt(fabs(x));</span><br><span class="line"></span><br><span class="line">ret += (<span class="number">20.0</span> * sin(<span class="number">6.0</span> * x * M_PI) + <span class="number">20.0</span> * sin(<span class="number">2.0</span> * x * M_PI)) * <span class="number">2.0</span> / <span class="number">3.0</span>;</span><br><span class="line"></span><br><span class="line">ret += (<span class="number">20.0</span> * sin(x * M_PI) + <span class="number">40.0</span> * sin(x / <span class="number">3.0</span> * M_PI)) * <span class="number">2.0</span> / <span class="number">3.0</span>;</span><br><span class="line"></span><br><span class="line">ret += (<span class="number">150.0</span> * sin(x / <span class="number">12.0</span> * M_PI) + <span class="number">300.0</span> * sin(x / <span class="number">30.0</span> * M_PI)) * <span class="number">2.0</span> / <span class="number">3.0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> transform_earth_2_mars(<span class="keyword">double</span> lat, <span class="keyword">double</span> lng, <span class="keyword">double</span>* tarLat, <span class="keyword">double</span>* tarLng) &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (transform_sino_out_china(lat, lng)) &#123;</span><br><span class="line"></span><br><span class="line">*tarLat = lat;</span><br><span class="line"></span><br><span class="line">*tarLng = lng;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> dLat = transform_earth_2_mars_lat(lng - <span class="number">105.0</span>, lat - <span class="number">35.0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> dLon = transform_earth_2_mars_lng(lng - <span class="number">105.0</span>, lat - <span class="number">35.0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> radLat = lat / <span class="number">180.0</span> * M_PI;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> magic = sin(radLat);</span><br><span class="line"></span><br><span class="line">magic = <span class="number">1</span> - ee * magic * magic;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> sqrtMagic = sqrt(magic);</span><br><span class="line"></span><br><span class="line">dLat = (dLat * <span class="number">180.0</span>) / ((a * (<span class="number">1</span> - ee)) / (magic * sqrtMagic) * M_PI);</span><br><span class="line"></span><br><span class="line">dLon = (dLon * <span class="number">180.0</span>) / (a / sqrtMagic * cos(radLat) * M_PI);</span><br><span class="line"></span><br><span class="line">*tarLat = lat + dLat;</span><br><span class="line"></span><br><span class="line">*tarLng = lng + dLon;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> x_pi = M_PI * <span class="number">3000.0</span> / <span class="number">180.0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> transform_mars_2_bear_paw(<span class="keyword">double</span> gg_lat, <span class="keyword">double</span> gg_lon, <span class="keyword">double</span> *bd_lat, <span class="keyword">double</span> *bd_lon) &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> x = gg_lon, y = gg_lat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> z = sqrt(x * x + y * y) + <span class="number">0.00002</span> * sin(y * x_pi);</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> theta = atan2(y, x) + <span class="number">0.000003</span> * cos(x * x_pi);</span><br><span class="line"></span><br><span class="line">*bd_lon = z * cos(theta) + <span class="number">0.0065</span>;</span><br><span class="line"></span><br><span class="line">*bd_lat = z * sin(theta) + <span class="number">0.006</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> transform_bear_paw_2_mars(<span class="keyword">double</span> bd_lat, <span class="keyword">double</span> bd_lon, <span class="keyword">double</span> *gg_lat, <span class="keyword">double</span> *gg_lon) &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> x = bd_lon - <span class="number">0.0065</span>, y = bd_lat - <span class="number">0.006</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> z = sqrt(x * x + y * y) - <span class="number">0.00002</span> * sin(y * x_pi);</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> theta = atan2(y, x) - <span class="number">0.000003</span> * cos(x * x_pi);</span><br><span class="line"></span><br><span class="line">*gg_lon = z * cos(theta);</span><br><span class="line"></span><br><span class="line">*gg_lat = z * sin(theta);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<h3 id="å…­ã€å†™åœ¨æœ€å"><a href="#å…­ã€å†™åœ¨æœ€å" class="headerlink" title="å…­ã€å†™åœ¨æœ€å"></a>å…­ã€å†™åœ¨æœ€å</h3><p>æœ¬æ–‡æ²¡æœ‰æ¶‰åŠè¯¦ç»†å¼€å‘æ­¥éª¤ï¼Œä¸»è¦å°±æ˜¯ã€ç‚¹ä¸€ä¸‹ç‹¼å‘ã€è€Œå·²ï¼Œå¸¸è§„çš„å¼€å‘ç½‘ä¸Šæœ‰å¾ˆå¤šï¼Œè€Œä¸”è¿˜æœ‰å„è‡ªçš„å®˜æ–¹å¼€å‘æ–‡æ¡£ã€‚</p>
<p>ç›®çš„æ˜¯ä»‹ç»åœ°å›¾å¼€å‘ä¸­ä¸€äº›å¯èƒ½å‡ºç°çš„é—®é¢˜ï¼Œä¹Ÿéƒ½æ˜¯æˆ‘åœ¨å¼€å‘ä¸­çš„ã€å¿ƒè·¯å†ç¨‹ã€ã€‚æœ‰ä¸å¯¹çš„åœ°æ–¹ï¼Œæ¬¢è¿æŒ‡æ­£ï¼</p>
<p><img src="http://upload-images.jianshu.io/upload_images/6544436-a76840f0010c1446.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/700" alt="å°±æ˜¯æƒ³é…ä¸ªå›¾.png"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/31/ç›‘æµ‹é‚£äº›å¸¸è§„æ–¹æ³•æ•æ‰ä¸åˆ°çš„å˜åŒ–-è§‚å¯Ÿè€…æ¨¡å¼/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Leewin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Welcome">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/31/ç›‘æµ‹é‚£äº›å¸¸è§„æ–¹æ³•æ•æ‰ä¸åˆ°çš„å˜åŒ–-è§‚å¯Ÿè€…æ¨¡å¼/" itemprop="url">ç›‘æµ‹é‚£äº›å¸¸è§„æ–¹æ³•æ•æ‰ä¸åˆ°çš„å˜åŒ–-è§‚å¯Ÿè€…æ¨¡å¼</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-10-31T09:08:10+08:00">
                2017-10-31
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="ä¸€ã€ä½ å¯èƒ½é‡åˆ°è¿‡çš„é—®é¢˜"><a href="#ä¸€ã€ä½ å¯èƒ½é‡åˆ°è¿‡çš„é—®é¢˜" class="headerlink" title="ä¸€ã€ä½ å¯èƒ½é‡åˆ°è¿‡çš„é—®é¢˜"></a>ä¸€ã€ä½ å¯èƒ½é‡åˆ°è¿‡çš„é—®é¢˜</h3><h4 id="Question-1-ä½¿ç”¨UITextFieldæ—¶ï¼›"><a href="#Question-1-ä½¿ç”¨UITextFieldæ—¶ï¼›" class="headerlink" title="Question 1.ä½¿ç”¨UITextFieldæ—¶ï¼›"></a>Question 1.ä½¿ç”¨UITextFieldæ—¶ï¼›</h4><p>å½“ä½ æƒ³æ—¶æ—¶ç›‘æµ‹textField.textçš„å˜åŒ–ï¼Œä»¥è·å–æœ€æ–°çš„textï¼Œä½ æ˜¯ç”¨è¿™æ ·çš„ä»£ç†æ–¹æ³•å—ï¼Ÿ</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">BOOL</span>)textField:(<span class="built_in">UITextField</span> *)textField shouldChangeCharactersInRange:(<span class="built_in">NSRange</span>)range replacementString:(<span class="built_in">NSString</span> *)string &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (textField == <span class="keyword">self</span>.textField) &#123;</span><br><span class="line"><span class="built_in">NSString</span> *futureStr = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%@%@"</span>, textField.text, string];</span><br><span class="line"><span class="keyword">if</span> ([futureStr isEqualToString:<span class="string">@"000"</span>]) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"----------The text value is 000----------"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Question-2-ä½¿ç”¨UIWebViewæˆ–WKWebViewæ—¶ï¼›"><a href="#Question-2-ä½¿ç”¨UIWebViewæˆ–WKWebViewæ—¶ï¼›" class="headerlink" title="Question 2.ä½¿ç”¨UIWebViewæˆ–WKWebViewæ—¶ï¼›"></a>Question 2.ä½¿ç”¨UIWebViewæˆ–WKWebViewæ—¶ï¼›</h4><p>ç”±äºç½‘é¡µç«¯ç”¨Ajaxï¼Œå¯¼è‡´æˆ‘ä»¬å¹¶ä¸èƒ½ç”¨å¸¸è§„çš„ç½‘é¡µåŠ è½½ä»£ç†æ–¹æ³•æ¥æ£€æµ‹webViewçš„titleçš„å€¼~æ¯”å¦‚è¿™æ ·<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)webView:(<span class="built_in">WKWebView</span> *)webView didFinishNavigation:(<span class="built_in">WKNavigation</span> *)navigation &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (webView.title.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">self</span>.title = webView.title;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="äºŒã€è¿™é‡Œæˆ‘ä»¬å°±éœ€è¦ç”¨ä¸Šè§‚å¯Ÿè€…æ¨¡å¼äº†"><a href="#äºŒã€è¿™é‡Œæˆ‘ä»¬å°±éœ€è¦ç”¨ä¸Šè§‚å¯Ÿè€…æ¨¡å¼äº†" class="headerlink" title="äºŒã€è¿™é‡Œæˆ‘ä»¬å°±éœ€è¦ç”¨ä¸Šè§‚å¯Ÿè€…æ¨¡å¼äº†"></a>äºŒã€è¿™é‡Œæˆ‘ä»¬å°±éœ€è¦ç”¨ä¸Šè§‚å¯Ÿè€…æ¨¡å¼äº†</h3><p>KVOï¼Œå³key-value-observing,åˆ©ç”¨ä¸€ä¸ªkeyæ¥æ‰¾åˆ°æŸä¸ªå±æ€§å¹¶ç›‘å¬å…¶å€¼å¾—æ”¹å˜ã€‚å…¶å®è¿™ä¹Ÿæ˜¯ä¸€ç§å…¸å‹çš„è§‚å¯Ÿè€…æ¨¡å¼ã€‚</p>
<ul>
<li>1ï¼Œæ·»åŠ è§‚å¯Ÿè€…</li>
<li>2ï¼Œåœ¨è§‚å¯Ÿè€…ä¸­å®ç°ç›‘å¬æ–¹æ³•ï¼ŒobserveValueForKeyPath: ofObject: change: context:ï¼ˆå› ä¸ºè¿™ä¸ªæ–¹æ³•å±äºNSObjectï¼Œæ‰€ä»¥ï¼Œå¯ä»¥ç”¨äºæ£€æµ‹ä»»ä½•å¯¹è±¡çš„ä»»ä½•å±æ€§çš„å˜åŒ–ï¼‰</li>
<li>3ï¼Œç§»é™¤è§‚å¯Ÿè€…</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">ç”¨ä¸‡èƒ½çš„Userç±»æ¥ç…®ä¸ªæ —å­~</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">- (<span class="keyword">void</span>)addObserverForUserName &#123;</span><br><span class="line"></span><br><span class="line">User *user = [[User alloc] init];</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Whether the change dictionaries sent in notifications</span></span><br><span class="line"><span class="comment">should contain NSKeyValueChangeNewKey and NSKeyValueChangeOldKey entries, respectively.</span></span><br><span class="line"><span class="comment">-------------------------------------------------------------</span></span><br><span class="line"><span class="comment">NSKeyValueObservingOptionNew = 0x01,æ–°å€¼</span></span><br><span class="line"><span class="comment">NSKeyValueObservingOptionOld = 0x02,æ—§å€¼</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">[user addObserver:<span class="keyword">self</span> forKeyPath:<span class="string">@"name"</span> options:<span class="built_in">NSKeyValueObservingOptionNew</span> context:<span class="literal">nil</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">ç›‘æµ‹ user çš„ name å±æ€§ å‘ç”Ÿå˜åŒ–çš„æƒ…å†µ</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">@param keyPath è¢«ç›‘å¬çš„å±æ€§</span></span><br><span class="line"><span class="comment">@param object è¢«ç›‘å¬çš„å¯¹è±¡</span></span><br><span class="line"><span class="comment">@param change æ–°å€¼å’Œæ—§å€¼</span></span><br><span class="line"><span class="comment">@param context é™„åŠ çš„é¢å¤–æ•°æ®</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">- (<span class="keyword">void</span>)observeValueForKeyPath:(<span class="built_in">NSString</span> *)keyPath</span><br><span class="line">ofObject:(<span class="keyword">id</span>)object</span><br><span class="line">change:(<span class="built_in">NSDictionary</span>&lt;<span class="built_in">NSKeyValueChangeKey</span>,<span class="keyword">id</span>&gt; *)change</span><br><span class="line">context:(<span class="keyword">void</span> *)context &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ([keyPath isEqualToString:<span class="string">@"name"</span>] &amp;&amp; [object isEqual:user]) &#123;</span><br><span class="line"><span class="comment">// Do Something</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"----------user'name has changed----------"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)dealloc &#123;</span><br><span class="line"></span><br><span class="line">[user removeObserver:<span class="keyword">self</span> forKeyPath:<span class="string">@"name"</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ä¸‰ã€è§£å†³ä¸Šè¿°åŠç±»ä¼¼çš„é—®é¢˜"><a href="#ä¸‰ã€è§£å†³ä¸Šè¿°åŠç±»ä¼¼çš„é—®é¢˜" class="headerlink" title="ä¸‰ã€è§£å†³ä¸Šè¿°åŠç±»ä¼¼çš„é—®é¢˜"></a>ä¸‰ã€è§£å†³ä¸Šè¿°åŠç±»ä¼¼çš„é—®é¢˜</h3><h4 id="Answer-1"><a href="#Answer-1" class="headerlink" title="Answer 1"></a>Answer 1</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[self.textField addTarget:self action:@selector(textFieldDidChange:) </span><br><span class="line">forControlEvents:UIControlEventEditingChanged];</span><br><span class="line"></span><br><span class="line">- (void)textFieldDidChange:(UITextField *)textField &#123;</span><br><span class="line">// TODO</span><br><span class="line">if ([textField.text isEqualToString:@&quot;000&quot;]) &#123;</span><br><span class="line">NSLog(@&quot;----------The text value is 000----------&quot;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Answer-2"><a href="#Answer-2" class="headerlink" title="Answer 2"></a>Answer 2</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">ä¸ºwebViewé…ç½®ç›‘å¬è€…</span><br><span class="line">*/</span><br><span class="line">- (void)configWebViewObserver &#123;</span><br><span class="line"></span><br><span class="line">[webView addObserver:self forKeyPath:@&quot;title&quot; options:NSKeyValueObservingOptionNew context:nil];</span><br><span class="line">[webView addObserver:self forKeyPath:@&quot;estimatedProgress&quot; options:NSKeyValueObservingOptionNew context:nil];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)observeValueForKeyPath:(NSString *)keyPath</span><br><span class="line">ofObject:(id)object</span><br><span class="line">change:(NSDictionary&lt;NSKeyValueChangeKey,id&gt; *)change</span><br><span class="line">context:(void *)context &#123;</span><br><span class="line"></span><br><span class="line">if ([keyPath isEqualToString:@&quot;title&quot;] &amp;&amp; [object isEqual:webView]) &#123;</span><br><span class="line">self.title = self.webView.title;</span><br><span class="line">&#125; else if ([keyPath isEqualToString:@&quot;estimatedProgress&quot;] &amp;&amp; [object isEqual:webView]) &#123;</span><br><span class="line">self.progressView.progress = self.webView.estimatedProgress;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)dealloc &#123;</span><br><span class="line"></span><br><span class="line">[self.webView removeObserver:self forKeyPath:@&quot;title&quot;];</span><br><span class="line">[self.webView removeObserver:self forKeyPath:@&quot;estimatedProgress&quot;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="é™„ï¼šå†æ¥ä¸€å‘ç›‘å¬UITableViewçš„contentOffset"><a href="#é™„ï¼šå†æ¥ä¸€å‘ç›‘å¬UITableViewçš„contentOffset" class="headerlink" title="é™„ï¼šå†æ¥ä¸€å‘ç›‘å¬UITableViewçš„contentOffset"></a>é™„ï¼šå†æ¥ä¸€å‘ç›‘å¬UITableViewçš„contentOffset</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">- (void)configObserverForTableView &#123;</span><br><span class="line"></span><br><span class="line">[tableView addObserver:self forKeyPath:@&quot;contentOffset&quot; options:NSKeyValueObservingOptionNew context:nil];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)observeValueForKeyPath:(NSString *)keyPath</span><br><span class="line">ofObject:(id)object</span><br><span class="line">change:(NSDictionary&lt;NSString *,id&gt; *)change</span><br><span class="line">context:(void *)context &#123;</span><br><span class="line"></span><br><span class="line">if ([keyPath isEqualToString:@&quot;contentOffset&quot;] &amp;&amp; object == tableView) &#123;</span><br><span class="line"></span><br><span class="line">CGFloat offsetY             = self.contentOffset.y;</span><br><span class="line">CGFloat offsetX             = self.contentOffset.x;</span><br><span class="line">NSLog(@&quot;----------offsetX = %f, offsetY = %f----------&quot;, offsetX, offsetY);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)dealloc &#123;</span><br><span class="line"></span><br><span class="line">[tableView removeObserver:self forKeyPath:@&quot;contentOffset&quot;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="çœ‹åˆ°è¿™é‡Œå¤§å®¶ä¸€å®šå°±èƒ½æ˜ç™½è§‚å¯Ÿè€…æ¨¡å¼çš„åŸºæœ¬å¥—è·¯äº†å§ï¼Œå¿ƒé‡Œçªç„¶å“èµ·äº†éŸ³ä¹ï¼šâ€å…¶å®å¾ˆç®€å•ï¼Œå…¶å®å¾ˆè‡ªç„¶â€"><a href="#çœ‹åˆ°è¿™é‡Œå¤§å®¶ä¸€å®šå°±èƒ½æ˜ç™½è§‚å¯Ÿè€…æ¨¡å¼çš„åŸºæœ¬å¥—è·¯äº†å§ï¼Œå¿ƒé‡Œçªç„¶å“èµ·äº†éŸ³ä¹ï¼šâ€å…¶å®å¾ˆç®€å•ï¼Œå…¶å®å¾ˆè‡ªç„¶â€" class="headerlink" title="çœ‹åˆ°è¿™é‡Œå¤§å®¶ä¸€å®šå°±èƒ½æ˜ç™½è§‚å¯Ÿè€…æ¨¡å¼çš„åŸºæœ¬å¥—è·¯äº†å§ï¼Œå¿ƒé‡Œçªç„¶å“èµ·äº†éŸ³ä¹ï¼šâ€å…¶å®å¾ˆç®€å•ï¼Œå…¶å®å¾ˆè‡ªç„¶â€~"></a>çœ‹åˆ°è¿™é‡Œå¤§å®¶ä¸€å®šå°±èƒ½æ˜ç™½è§‚å¯Ÿè€…æ¨¡å¼çš„åŸºæœ¬å¥—è·¯äº†å§ï¼Œå¿ƒé‡Œçªç„¶å“èµ·äº†éŸ³ä¹ï¼šâ€å…¶å®å¾ˆç®€å•ï¼Œå…¶å®å¾ˆè‡ªç„¶â€~</h4><h3 id="å››ã€å†™åœ¨æœ€å"><a href="#å››ã€å†™åœ¨æœ€å" class="headerlink" title="å››ã€å†™åœ¨æœ€å"></a>å››ã€å†™åœ¨æœ€å</h3><ul>
<li>æ­¤æ–¹æ³•å¯ç”¨äºç›‘å¬ä¸€åˆ‡å¯¹è±¡çš„å±æ€§å˜åŒ–ï¼ŒåŒ…æ‹¬ç³»ç»Ÿçš„ç±»ï¼ˆUITableViewã€UIWebViewç­‰ï¼‰å’Œè‡ªå®šä¹‰çš„ç±»ï¼ˆUserã€Carç­‰ï¼‰</li>
<li>ä¸Šé¢çš„Userç±»æ˜¯é€šä¾‹ï¼Œå±äºåŸºæœ¬æ¨¡å‹ï¼Œå®é™…æƒ…å†µæœ‰éœ€æ±‚è€Œå®š</li>
<li>è¿˜å¯ä»¥ç”¨äºç›‘å¬åŠ¨ç”»çš„ç‰¹æ®Šæ—¶åˆ»ï¼Œæ¯”å¦‚ï¼šframeã€colorç­‰å˜åŒ–</li>
<li>ä¸€å®šè®°å¾—åœ¨ææ„å‡½æ•°é‡Œç§»é™¤ç›‘å¬ï¼›</li>
<li>ä¸€å®šè®°å¾—åœ¨ææ„å‡½æ•°é‡Œç§»é™¤ç›‘å¬ï¼›</li>
<li>ä¸€å®šè®°å¾—åœ¨ææ„å‡½æ•°é‡Œç§»é™¤ç›‘å¬â€¦â€¦</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/6544436-14c27f87b0767d29.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æˆ‘æ˜¯ä¸æ–‡æ— å…³çš„å›¾.JPG"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Leewin</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Leewin</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
